<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" type="text/css" href="/dash/assets/felib/bootstrap/main/dist/css/bootstrap.min.css?v=1e45d53e"><link rel="stylesheet" type="text/css" href="/dash/assets/felib/@loadingio/bootstrap.ext/main/index.min.css?v=1e45d53e"><link rel="stylesheet" type="text/css" href="/dash/assets/felib/@loadingio/loading.css/main/loading.min.css?v=1e45d53e"><link rel="stylesheet" type="text/css" href="/dash/assets/felib/ldiconfont/main/ldif.min.css?v=1e45d53e"><link rel="stylesheet" type="text/css" href="/dash/assets/felib/ldbutton/main/index.min.css?v=1e45d53e"><link rel="stylesheet" type="text/css" href="/dash/assets/felib/ldcover/main/index.min.css?v=1e45d53e"><link rel="stylesheet" type="text/css" href="/dash/assets/felib/ldloader/main/index.min.css?v=1e45d53e"><link rel="stylesheet" type="text/css" href="/dash/css/modules/authpanel.min.css?v=1e45d53e"><link rel="stylesheet" type="text/css" href="/sys/css/index.css?v=1e45d53e"><style type="text/css">body {
  scroll-behavior: smooth;
}
@font-face {
  font-family: 'ldi';
  font-weight: normal;
  font-style: normal;
  src: url("/dash/assets/felib/ldiconfont/main/ldif.ttf") format('truetype');
}
</style><script>if(/MSIE|Trident/.exec(navigator.userAgent)) { window.location.href = "/err/ie/" };</script></head><body><div class="ldcv ldcvmgr" data-name="submitting" data-lock="true"><div class="base w-480 rwd"><div class="inner card"><div class="card-body"><div class="p-4"><div class="text-center"><div>送件中 ...</div><div class="ld ld-spin ld-spinner text-lg mt-4"></div></div></div></div></div></div></div><div class="ldcv ldcvmgr" data-name="submitted" data-lock="true"><div class="base w-640 rwd"><div class="inner card"><div class="card-body"><div class="p-4"><h2 class="text-center">您的案件已送出</h2><br><p>注意事項：</p><ol class="pl-4"><li>送件後無法繼續編輯，若您發現有任何問題需要修正，請洽承辦人員。</li><li>所送資料將交由計畫委員進行審查，若委員要求貴單位補充文件內容或資料，將另行通知。</li><li>請先製作簡報，後續將另行通知簡報上傳時間。</li><li>若貴單位通過審查，請於審查會議後下載表單PDF檔，印出紙本後用印寄回，以辦理結案作業。</li></ol><br><div class="btn btn-lg btn-primary btn-block" data-ldcv-set="">關閉</div></div></div></div></div></div><div class="ldcv ldcvmgr" data-name="saving" data-lock="true"><div class="base w-480 rwd"><div class="inner card"><div class="card-body"><div class="p-4"><div class="text-center"><div>暫存進度中 ...</div><div class="ld ld-spin ld-spinner text-lg mt-4"></div></div></div></div></div></div></div><div class="ldcv ldcvmgr" data-name="saved" data-lock="true"><div class="base w-480 rwd"><div class="inner card"><div class="card-body"><div class="p-4"><div class="text-center"><h2>您的編輯進度已儲存。</h2></div><div class="py-4"><p>您隨時可以回到這個頁面繼續編輯。若需要回到此頁，請由網頁右上角的下拉選單中點選「個人頁面」，即可找到您建立的案件。</p></div><div class="btn btn-lg btn-primary btn-block ld-ext-right" data-ldcv-set="">關閉</div></div></div></div></div></div><div class="ldcv ldcvmgr" data-name="print-timeout" data-lock="true"><div class="base w-480 rwd"><div class="inner card"><div class="card-body"><div class="p-4"><div class="text-center"><h2>連線逾時</h2></div><div class="py-4"><p>主機沒有在一定的時間內產生 PDF 檔，可能是因為服務忙碌中。您可以稍候再重試一次，或者直接將此頁面列印成 PDF 檔做為您的申請書。</p></div><div class="row"><div class="col-md"><div class="btn btn-lg btn-block btn-outline-primary btn-block" onclick="lda.ldcvmgr.toggle('flagship-print-timeout',false).then(function(){print()})">列印此頁面</div></div><div class="col-md"><div class="btn btn-lg btn-block btn-primary" data-ldcv-set="">稍候再試</div></div></div></div></div></div></div></div><script type="text/javascript" src="/dash/assets/lib/moment.js/2.25.3/moment.min.js?v=1e45d53e" defer></script><script type="text/javascript" src="/dash/assets/lib/moment-timezone.js/0.5.31/moment-timezone.min.js?v=1e45d53e" defer></script><script type="text/javascript" src="/dash/assets/lib/ldui/ldui.min.js?v=1e45d53e" defer></script><script type="text/javascript" src="/dash/assets/lib/ldc/ldc.min.js?v=1e45d53e" defer></script><script type="text/javascript" src="/dash/assets/lib/ldsite/0.0.2/ldsite.min.js?v=1e45d53e" defer></script><script type="text/javascript" src="/dash/js/util/stage.js?v=1e45d53e" defer></script><script type="text/javascript" src="/dash/js/ldsite.js?v=1e45d53e" defer></script><script type="text/javascript" src="/dash/js/site.js?v=1e45d53e" defer></script><script type="text/javascript" src="/dash/assets/felib/proxise/main/index.min.js?v=1e45d53e" defer></script><script type="text/javascript" src="/dash/assets/felib/@loadingio/debounce.js/main/index.min.js?v=1e45d53e" defer></script><script type="text/javascript" src="/dash/assets/felib/@loadingio/ldquery/main/index.min.js?v=1e45d53e" defer></script><script type="text/javascript" src="/dash/assets/felib/i18next/main/dist/umd/i18next.min.js?v=1e45d53e" defer></script><script type="text/javascript" src="/dash/assets/felib/i18next-browser-languagedetector/main/dist/umd/i18nextBrowserLanguageDetector.min.js?v=1e45d53e" defer></script><script type="text/javascript" src="/dash/assets/felib/ldview/main/index.min.js?v=1e45d53e" defer></script><script type="text/javascript" src="/dash/assets/felib/ldcover/main/index.min.js?v=1e45d53e" defer></script><script type="text/javascript" src="/dash/assets/felib/ldfile/main/index.min.js?v=1e45d53e" defer></script><script type="text/javascript" src="/dash/assets/felib/ldloader/main/index.min.js?v=1e45d53e" defer></script><script type="text/javascript" src="/dash/assets/felib/@plotdb/semver/main/index.min.js?v=1e45d53e" defer></script><script type="text/javascript" src="/dash/assets/felib/@plotdb/rescope/main/index.min.js?v=1e45d53e" defer></script><script type="text/javascript" src="/dash/assets/felib/@plotdb/csscope/main/index.min.js?v=1e45d53e" defer></script><script type="text/javascript" src="/dash/assets/felib/@plotdb/block/main/index.min.js?v=1e45d53e" defer></script><script type="module">ldc.register("viewLocals", [], function() {
  return JSON.parse(unescape("null"));
});</script><script type="module">// Generated by LiveScript 1.3.0
ldc.register("blockbase", ['blockuploader', 'viewLocals', 'auth', 'ldNotify', 'error', 'notify', 'ldcvmgr'], function(arg$){
  var blockuploader, viewLocals, auth, error, notify, ldcvmgr;
  blockuploader = arg$.blockuploader, viewLocals = arg$.viewLocals, auth = arg$.auth, error = arg$.error, notify = arg$.notify, ldcvmgr = arg$.ldcvmgr;
  return {
    init: function(arg$){
      var blockdef, brd, ldld;
      blockdef = arg$.blockdef, brd = arg$.brd;
      ldld = new ldloader({
        className: 'ldld full z-fixed'
      });
      return auth.ensure().then(function(global){
        return auth.get().then(function(global){
          var binfo, prj, user, owner, uploadr, host, customData, ref$, lc, this$ = this;
          binfo = {};
          prj = (viewLocals || {}).prj || {};
          user = global.user || {};
          owner = prj.owner || user.key || 0;
          uploadr = new blockuploader({
            brd: brd,
            owner: owner
          });
          host = {
            changeLanguage: function(lng){
              i18next.changeLanguage(lng);
              return binfo.instance.transform('i18n');
            },
            info: {
              prj: {
                slug: prj.slug,
                state: prj.state
              },
              user: {
                key: user.key,
                username: user.username,
                displayname: user.displayname
              }
            },
            upload: function(o){
              return uploadr.upload(o)['catch'](error());
            },
            print: function(opt){
              var html, name;
              opt == null && (opt = {});
              html = opt.html || "";
              name = opt.name || "download.pdf";
              ldld.on();
              return auth.recaptcha.get().then(function(recaptcha){
                return ld$.fetch("/dash/api/custom/print", {
                  method: "POST"
                }, {
                  json: {
                    html: html,
                    recaptcha: recaptcha
                  },
                  type: 'blob',
                  timeout: 60 * 1000
                }).then(function(blob){
                  return ldfile.download({
                    blob: blob,
                    mime: "application/pdf",
                    name: name
                  });
                })['finally'](function(){
                  return ldld.off();
                });
              });
            },
            save: function(arg$){
              var name, description, data, submit;
              name = arg$.name, description = arg$.description, data = arg$.data, submit = arg$.submit;
              ldcvmgr.toggle(submit ? 'submitting' : 'saving', true);
              return debounce(1000).then(function(){
                return auth.recaptcha.get();
              }).then(function(recaptcha){
                var payload;
                payload = {
                  name: name,
                  description: description,
                  custom: data,
                  submit: submit,
                  recaptcha: recaptcha,
                  slug: prj.slug,
                  brd: brd
                };
                return ld$.fetch("/dash/api/custom/prj", {
                  method: "POST"
                }, {
                  json: payload,
                  type: 'json'
                });
              }).then(function(it){
                console.log("saved return value: ", it);
                ldcvmgr.toggle(submit ? 'submitted' : 'saved');
                return it;
              })['finally'](function(){
                return ldcvmgr.toggle(submit ? 'submitting' : 'saving', false);
              })['catch'](function(e){
                error()(e);
                return Promise.reject(e);
              });
            }
          };
          customData = ((ref$ = (viewLocals || {}).prj || {}).detail || (ref$.detail = {})).custom || {};
          lc = {};
          return i18next.init({
            supportedLng: ['en', 'zh-TW'],
            fallbackLng: 'zh-TW',
            fallbackNS: '',
            defaultNS: ''
          }).then(function(){
            return i18next.use(i18nextBrowserLanguageDetector);
          }).then(function(){
            console.log("use language: ", navigator.language) || navigator.userLanguage;
            return i18next.changeLanguage(navigator.language) || navigator.userLanguage;
          }).then(function(){
            return block.i18n.use(i18next);
          }).then(function(){
            var mgr;
            lc.manager = mgr = new block.manager({
              registry: function(arg$){
                var name, version, path, type;
                name = arg$.name, version = arg$.version, path = arg$.path, type = arg$.type;
                return type === 'block'
                  ? "/dash/assets/felib/" + name + "/" + (version || 'main') + "/" + (path || 'index.html') + "?dec=" + (global.version || '')
                  : "/dash/assets/felib/" + name + "/" + (version || 'main') + "/" + (path || 'index.min.js') + "?dec=" + (global.version || '');
              }
            });
            return mgr.get(blockdef).then(function(bc){
              return bc.create();
            }).then(function(bi){
              return bi.attach({
                root: document.body
              }).then(function(){
                return bi['interface']();
              }).then(function(itf){
                binfo['interface'] = itf;
                binfo.instance = bi;
                itf.adapt(host);
                return itf.load(customData);
              });
            }).then(function(){
              return console.log("block " + name + " loaded.");
            });
          });
        });
      });
    }
  };
});// Generated by LiveScript 1.3.0
ldc.register("blockuploader", ['viewLocals', 'auth', 'ldNotify', 'error', 'notify'], function(arg$){
  var viewLocals, auth, error, notify, uploader;
  viewLocals = arg$.viewLocals, auth = arg$.auth, error = arg$.error, notify = arg$.notify;
  uploader = function(opt){
    opt == null && (opt = {});
    this.brd = opt.brd;
    this.owner = opt.owner;
    return this;
  };
  uploader.prototype = import$(Object.create(Object.prototype), {
    getSignedUrl: function(opt){
      opt == null && (opt = {});
      return ld$.fetch("/dash/api/gcs/upload", {
        method: 'POST'
      }, {
        json: opt,
        type: 'json'
      });
    },
    upload: function(arg$){
      var file, progress, field, opt, this$ = this;
      file = arg$.file, progress = arg$.progress, field = arg$.field;
      opt = {
        filename: file.name,
        size: file.size,
        field: field,
        owner: this.owner,
        brd: this.brd
      };
      return this.getSignedUrl(opt).then(function(arg$){
        var signedUrl, id;
        signedUrl = arg$.signedUrl, id = arg$.id;
        return ld$.xhr(signedUrl, {
          method: 'PUT',
          body: file,
          headers: {
            "Content-Type": file.type
          }
        }, {
          noDefaultHeaders: true,
          progress: function(it){
            if (progress) {
              return progress(it);
            }
          }
        }).then(function(){
          if (progress) {
            progress({
              percent: 1
            });
          }
          console.log('done');
          return {
            filename: file.name,
            size: file.size,
            modifiedtime: file.lastModified,
            url: "/dash/gcs/upload/" + id
          };
        });
      });
    }
  });
  return uploader;
});
function import$(obj, src){
  var own = {}.hasOwnProperty;
  for (var key in src) if (own.call(src, key)) obj[key] = src[key];
  return obj;
}</script><script type="module">// Generated by LiveScript 1.3.0
ldc.register(['blockbase', 'viewLocals', 'auth', 'ldNotify', 'error', 'notify'], function(arg$){
  var blockbase, viewLocals, auth, error, notify, blockdef, brd;
  blockbase = arg$.blockbase, viewLocals = arg$.viewLocals, auth = arg$.auth, error = arg$.error, notify = arg$.notify;
  blockdef = {
    name: '@taiccadash/icg-111',
    version: 'main'
  };
  brd = "icg-111";
  return blockbase.init({
    blockdef: blockdef,
    brd: brd
  })['catch'](function(it){
    console.log('failed: ', it);
    return Promise.reject(it);
  });
});</script></body></html>