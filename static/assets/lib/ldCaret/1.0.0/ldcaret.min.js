(function(){var ldCaret;ldCaret={get:function(){var sel,range,obj,n,ref$;sel=window.getSelection();if(!sel.rangeCount){return{}}range=sel.getRangeAt(0);obj={ns:range.startContainer,ne:range.endContainer,os:range.startOffset,oe:range.endOffset};n=obj.ns.childNodes[obj.os];if(n&&((ref$=n.nodeName)==="TEXTAREA"||ref$==="INPUT")){obj={ns:n,ne:n,os:n.selectionStart,oe:n.selectionEnd}}return obj},set:function(arg$){var ns,ne,os,oe,range,selection;ns=arg$.ns,ne=arg$.ne,os=arg$.os,oe=arg$.oe;if(ns.setSelectionRange){ns.focus();return ns.setSelectionRange(os,oe!=null?oe:os)}range=document.createRange();range.setStart(ns,os);range.setEnd(ne!=null?ne:ns,oe!=null?oe:os);selection=window.getSelection();selection.removeAllRanges();return selection.addRange(range)},clear:function(){var selection;selection=window.getSelection();return selection.removeAllRanges()},getPos:function(){var range;range=window.getSelection().getRangeAt(0);return range.getBoundingClientRect()},setDom:function(n){var range;range=window.getSelection().getRangeAt(0);range.deleteContents();return range.insertNode(n)},setContent:function(txt){var obj,range,n;obj=ldCaret.get();if(obj.ns.setRangeText){return obj.ns.setRangeText(txt)}range=window.getSelection().getRangeAt(0);range.deleteContents();if(txt){return range.insertNode(n=document.createTextNode(txt))}},getContent:function(opt){var text,range;if(!opt){return text=window.getSelection().toString()}range=document.createRange();range.setStart(opt.ns,opt.os);range.setEnd(opt.ne,opt.oe);return range.toString()}};return window.ldCaret=ldCaret})();
