<div><div class="form-group" plug="widget"><label class="text-capitalize d-flex align-items-end"><div><span ld="label"></span><span class="text-danger ml-2" ld="is-required">*</span></div><div class="flex-grow-1"></div><div class="m-edit"><div class="text-danger text-sm" ld="limitation"></div></div></label><div class="text-sm text-muted"><div ld="desc" style="margin:-.6em 0 .7em"></div></div><div class="m-edit" ld="input"><div><label class="mr-3 mb-2 clickable" ld-each="option"><input class="mr-1" ld="checkbox" type="checkbox"><span ld="text"></span></label></div><div ld="other"><label class="clickable d-flex align-items-center"><input class="mr-1" ld="other-check" type="checkbox"><div class="mr-2 text-nowrap">其它</div><input class="form-control form-control-sm" type="text" ld="other-text"></label></div></div><div class="m-edit"><div class="text-danger text-sm mt-2 note" ld-each="note"></div></div><div class="m-view" ld="content"></div></div><script type="@plotdb/block">var mod;module.exports={pkg:{name:"@makeform/checkbox",extend:{name:"@makeform/base"}},init:function(e){return e.pubsub.fire("init",{mod:mod(e)})}};mod=function(e){var u,t,n,r,o,i,a,l,c,f;u=e.root,t=e.ctx,n=e.data,r=e.parent,o=e.t,i=e.i18n;a=t.ldview;l={value:{list:[],other:{enabled:false,text:""}}};c="_"+Math.random().toString(36).substring(2);f=function(e){var t;l.meta=e;l.cfg=e.config;(t=l.cfg).other||(t.other={});return l.values=(e.config||{}).values||[]};f(n);return{init:function(e){var i,t,n=this;this.on("meta",function(){return f(n.serialize())});this.on("change",function(e){var t;l.value=e||{};l.value.list=((t=l.value).list||(t.list=[])).filter(function(e){return in$(e,l.values)});return n.view.render(["input","option","other-text","other-check"])});i=function(e){var t;e==null&&(e={});if(!l.value){l.value={}}if(e.list!=null){l.value.list=e.list}l.value.list=l.value.list.filter(function(e){return in$(e,l.values)});if(e.other){if(e.other.enabled!=null){((t=l.value).other||(t.other={})).enabled=e.other.enabled}if(e.other.text!=null){((t=l.value).other||(t.other={})).text=e.other.text}}return n.value(l.value)};return this.view=t=new a({root:u,action:{click:{"other-check":function(e){var t;t=e.node;return i({other:{enabled:!!t.checked}})}},input:{"other-text":function(e){var t;t=e.node;return i({other:{text:t.value}})}}},text:{label:function(){return o(l.meta.title||"untitled")},content:function(e){var t;t=e.node;if(n.isEmpty()){return"n/a"}else{return(n.content()||[]).join(", ")||"n/a"}}},handler:{"is-required":function(e){var t;t=e.node;return t.classList.toggle("d-none",!l.meta.isRequired)},desc:function(e){var t;t=e.node;t.classList.toggle("d-none",!l.meta.desc);return t.innerText=o(l.meta.desc||"")||""},input:function(e){var t;t=e.node;return t.classList.toggle("text-danger",n.status()===2)},other:function(e){var t;t=e.node;return t.classList.toggle("d-none",!l.cfg.other.enabled)},"other-check":function(e){var t,n;t=e.node;return t.checked=!!((n=l.value||(l.value={})).other||(n.other={})).enabled},"other-text":function(e){var t,n;t=e.node;return t.value=((n=l.value||(l.value={})).other||(n.other={})).text||""},limitation:function(e){var t;t=e.node;t.classList.toggle("d-none",!l.cfg.limitation);return t.innerHTML="• "+o(l.cfg.limitation||"")},option:{list:function(){return l.values||[]},key:function(e){return e},view:{action:{change:{checkbox:function(e){var t,n,r,o;t=e.node,n=e.ctx;r=Array.from(u.querySelectorAll("input[type=checkbox]")).filter(function(e){return!!e.checked}).map(function(e){return e.value});o={list:r};return i(o)}}},handler:{checkbox:function(e){var t,n;t=e.node,n=e.ctx;t.setAttribute("name",c);t.setAttribute("value",n);return t.checked=in$(n,(l.value||{}).list||[])}},text:{text:function(e){var t,n;t=e.node,n=e.ctx;return n}}}},note:{list:function(){if(Array.isArray(l.cfg.note)){return l.cfg.note}else if(l.cfg.note){return[l.cfg.note]}else{return[]}},key:function(e){return e},handler:function(e){var t,n;t=e.node,n=e.data;return t.innerText="• "+n}}}})},render:function(){return this.view.render()},isEmpty:function(e){var t;e=this.content(e)||[];e=e.filter(function(e){return in$(e,l.values)});t=Array.isArray(e)?!e.length:!e;return t},content:function(e){var t,n,r;e==null&&(e={});t=e.list||[];n=((r=l.cfg).other||(r.other={})).enabled&&(e.other||(e.other={})).enabled&&e.other.text?e.other.text:[];return t=t.concat(n)}}};function in$(e,t){var n=-1,r=t.length>>>0;while(++n<r)if(e===t[n])return true;return false}</script></div>