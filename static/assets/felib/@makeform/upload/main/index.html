<div><div class="form-group" plug="widget"><label ld="label"></label><div class="d-flex align-items-center mb-3"><div class="btn btn-primary btn-upload mr-2 px-4 ld-ext-right" ld="button"><span t>上傳</span><input type="file" ld="input"><div class="ld ld-spin ld-spinner"></div></div><a class="ml-2" t ld="file-info" rel="noopener noreferrer" target="_blank">尚未上傳文件</a></div><div class="text-danger text-sm"><div ld-each="limitation"></div></div></div><script type="@plotdb/block">var mod;module.exports={pkg:{name:"@makeform/upload",extend:{name:"@makeform/base"},i18n:{en:{"上傳":"upload","上傳中":"uploading","尚未上傳文件":"no file uploaded yet"}},dependencies:[{url:"https://cdn.jsdelivr.net/npm/moment@2.29.1/moment.min.js",async:false},{url:"https://cdn.jsdelivr.net/npm/moment-timezone@0.5.34/builds/moment-timezone-with-data.min.js"}]},init:function(e){return e.pubsub.fire("init",{mod:mod(e)})}};mod=function(e){var n,t,i,r,f,o,d,s,c;n=e.root,t=e.ctx,i=e.data,r=e.parent,f=e.t,o=e.i18n;d=t.ldview,s=t.moment;c=i||{};c.config||(c.config={});return{init:function(){var o,u,l,a=this;o={};this.on("change",function(e){o.file=e;return a.view.render("file-info")});u=function(e){var n;n=l.get("file-info");n.innerText=f("上傳中")+" / "+Math.floor(e.percent*1e4)/100+"%";return n.removeAttribute("href")};return this.view=l=new d({root:n,text:{label:function(){return f((c||{}).title||"untitled")}},action:{change:{input:function(e){var n,t,i,r;n=e.node;if(!a._upload){return}t=l.get("button");t.classList.toggle("running",true);i=(n.files||[])[0];n.value=null;r=!i?Promise.resolve().then(function(){return o.file=null}):a._upload({file:i,progress:u}).then(function(e){return o.file=e});return r["finally"](function(){return t.classList.toggle("running",false)}).then(function(){a.value(o.file);return l.render("file-info")})["catch"](function(e){a.fire("upload-failed",e);return Promise.reject(e)})}}},handler:{"file-info":function(e){var n,t,i,r;n=e.node;if(!(t=o.file)){n.removeAttribute("href");n.innerText=f("尚未上傳文件")}else{i=s(t.modifiedtime).tz("Asia/Taipei").format("YYYY-MM-DD hh:mm:ss");r=t.filename+" / "+Math.round(t.size/1024)+"KB / "+i;n.innerText=r;n.setAttribute("href",t.url)}return n.classList.toggle("text-danger",!t)},limitation:{list:function(){return c.limitation||[]},key:function(e){return e},handler:function(e){var n,t;n=e.node,t=e.data;return n.innerText="* "+f(t)}},input:function(e){var n;n=e.node;if(!a._upload||!!c.config.readonly){return n.setAttribute("disabled",true)}else{return n.removeAttribute("disabled")}},button:function(e){var n,t;n=e.node;t=!a._upload||!!c.config.readonly;return n.classList.toggle("disabled",t)}}})},render:function(){if(this.view){return this.view.render()}},adapt:function(e){this._upload=e.upload;return this.render()}}};</script></div>