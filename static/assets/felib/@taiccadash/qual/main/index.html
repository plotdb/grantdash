<div><div class="h-100 w-100 d-flex flex-column"><ul class="navbar-nav mr-auto"><li class="nav-item"><a class="nav-link" href="#"><i class="i-radio text-success"></i> 資格審查表 - <span ld="reviewer"></span></a></li></ul><div class="flex-grow-1 d-flex w-100" style="overflow:hidden;margin-top:-.5em"><div class="d-flex flex-column position-relative" style="flex:1 1 40%"><div class="w-100 h-100 position-absolute z-fixed border shadow rounded d-none bg-white" ld="reader" style="top:0;left:0"><div class="btn btn-lg btn-text position-absolute" ld="reader-close" style="top:.5em;right:.5em"><i class="i-close"></i></div><iframe class="w-100 h-100 border-0" ld="iframe"></iframe></div><div class="flex-grow-1 bg-white border-top border-bottom mt-3" style="overflow:scroll"><div class="w-100"><div class="p-2 d-flex align-items-center border-bottom border-secondary bg-light sticky shadow-sm z-float" style="top:0"><div class="mr-2 text-center px-2 clickable" ld="sort-custom" data-name="idx" style="width:6em">編號</div><div class="flex-grow-1 clickable mr-2" ld="sort" data-name="name">提案名稱</div><div class="mr-2 text-right px-2 clickable d-none" ld="show-budget sort" data-name="budget" style="width:50px">預算</div><div class="mr-2 d-flex text-muted text-center align-items-center"><div class="mx-2 clickable" ld="option sort" data-name="primary" data-value="0" style="width:3em"><span>資格審查結果</span></div></div></div><div class="prj px-2 py-2 d-flex align-items-center" ld-each="project"><div class="text-nowrap text-center text-sm mr-2" style="width:6em"><span ld="idx"></span></div><div class="flex-grow-1 text-truncate mr-2" style="width:15em"><div class="text-underline text-truncate clickable" ld="name"></div><div class="text-sm text-muted" ld="ownername"></div></div><div class="mr-2 text-right text-nowrap d-none" ld="show-budget" style="width:75px"><div><span class="text-sm text-muted mr-1">總數</span><b class="text-sm text-nowrap" ld="budget"></b></div><div><span class="text-sm text-muted mr-1">補助</span><b class="text-sm text-nowrap" ld="subsidy"></b></div></div><div class="mr-4 d-flex align-items-center text-muted justify-content-end clickable" ld="edit" style="width:6em;height:2em"><div class="mr-2 px-2 py-1 rounded" style="margin-top:5px" ld="result">未填</div><i class="i-pen"></i></div></div></div></div><div class="px-4 py-2 w-100"><div class="d-flex align-items-center"><div class="mr-4 text-sm"><div class="text-muted">審查進度</div><div class="d-flex align-items-center my-1" style="line-height:1rem"><span><div class="d-flex align-items-center"><div class="bg-success d-inline-block mr-1 rounded" style="width:1em;height:1em"></div><span class="mr-2">符合</span></div></span><span><div class="d-flex align-items-center"><div class="bg-warning d-inline-block mr-1 rounded" style="width:1em;height:1em"></div><span class="mr-2">需補正</span></div></span><span><div class="d-flex align-items-center"><div class="bg-danger d-inline-block mr-1 rounded" style="width:1em;height:1em"></div><span class="mr-2">不符合</span></div></span></div></div><div class="mr-2 flex-grow-1"><div class="text-muted text-sm d-flex"><div class="mr-4 flex-grow-1">完成度 / <span class="text-danger" ld="progress progress-percent">0</span>%</div><div class="text-dark mr-4">已審: <span ld="count" data-name="done"></span></div><div class="text-dark">未審: <span ld="count" data-name="todo"></span></div></div><div class="progress my-1" style="width:100%"><div class="progress-bar bg-success progress-bar-striped progress-bar-animated" ld="progress progress-bar" data-name="符合"></div><div class="progress-bar bg-warning progress-bar-striped progress-bar-animated" ld="progress progress-bar" data-name="需補正"></div><div class="progress-bar bg-danger progress-bar-striped progress-bar-animated" ld="progress progress-bar" data-name="不符合"></div></div></div><div class="ml-4"><div class="btn btn-primary" ld="publish">發布</div></div></div></div></div><div style="flex:1 1 60%"><div class="card border shadow w-100 h-100" style="overflow:hidden;border-radius: .5em 0 0 .5em"><div class="card-body p-0"><div class="w-100 h-100 p-4" ld-scope ld="form" style="overflow-y:scroll"><p>案件編號：</p><table class="table table-bordered"><tr><th class="bg-light font-weight-bold" colspan="4">基本資料</th></tr><tr><th>申請單位</th><td ld="teamname"></td><th>產業類型</th><td ld="type"></td></tr><tr><th>計畫名稱</th><td ld="name" colspan="3"></td></tr><tr><th>計畫經費</th><td colspan="3"><div class="d-flex justify-content-between"><div>總經費 <span class="text-underline" ld="budget"></span> 元</div><div>申請經費 <span class="text-underline" ld="grant"></span> 元</div><div>自籌款 <span class="text-underline" ld="self-financing"></span> 元 ( <span class="text-underline" ld="self-fund-percent"></span> )</div></div></td></tr></table><table class="table table-bordered"><tr class="bg-light font-weight-bold"><th class="text-nowrap">項次</th><th class="text-nowrap">項目</th><th class="text-nowrap">必要</th><th class="text-nowrap">通過</th><th class="text-nowrap">不符</th><th class="text-nowrap">備註</th></tr><tr ld-each="item"><td class="align-middle text-center" ld="index"></td><td class="align-middle" ld="name"></td><td class="text-center align-middle" ld="required"><i class="i-check"></i></td><td class="text-center align-middle clickable" ld="check" data-name="yes" style="width:3em"><i class="i-check"></i></td><td class="text-center align-middle clickable" ld="check" data-name="no" style="width:3em"><i class="i-check"></i></td><td class="p-0 position-relative" style="width:10em"><textarea class="form-control border-0 w-100" ld="note" style="min-height:3em"></textarea></td></tr></table><div class="d-flex align-items-center mb-2" style="gap:1em"><div>通知日期</div><div ld="notify-date"></div><div class="flex-grow-1"></div><div>資格審查結果</div><div class="btn-group" style="width:14em"><div class="btn btn-outline-secondary" ld="result" data-name="accept">符合</div><div class="btn btn-outline-secondary" ld="result" data-name="reject">不符合</div><div class="btn btn-outline-secondary" ld="result" data-name="amend">需補正</div></div></div><div class="d-flex align-items-center mb-2" style="gap:1em"><div>補正日期</div><div ld="amend-date"></div><div class="flex-grow-1"></div><div>補正結果</div><div class="btn-group" style="width:14em"><div class="btn btn-outline-secondary" ld="amend" data-name="accept">完成補正</div><div class="btn btn-outline-secondary" ld="amend" data-name="reject">未完成補正</div></div></div><hr><div class="btn btn-primary px-4" ld="save">更新專案狀態</div></div></div></div></div></div></div><style type="text/css">:scope{width:100%;height:100%}.prj{border-top:1px solid #eee;border-bottom:1px solid #eee;margin-top:-1px}.prj.active{position:relative;z-index:10;border-top:1px solid #0ff;border-bottom:1px solid #0ff;background:#eff;box-shadow:0 0 5px rgba(0,255,255,0.3)}</style><script type="@plotdb/block">var pinfo,items;pinfo={};items=[{name:"提案計畫書",required:true},{name:"申請書",required:true},{name:"授權文件",required:true},{name:"共同提案之合作公司/組織之合約書或合作意向書",required:true},{name:"共同提案之推派代表同意書",required:true},{name:"預算規劃表",required:true},{name:"立案證明文件 ( 公司登記立案證明文件或財團(社團)法人、大專院校、學術研究機構或團體登記證書及章程影本 )",required:true},{name:"國稅局核發之「納稅義務人違章欠稅查復表」",required:true},{name:"金融機構或票據交換所於民國 110年 7 月 1 日以後開立之「第一類票據信用資料查覆單」",required:true},{name:"切結書",required:true},{name:"個人資料蒐集、處理、利用同意書",required:true},{name:"原著作、衍生著作及各該著作之著作財產權人書面授權文件"},{name:"工作團隊合作意向證明文件"}].map(function(e,r){return e.idx=r,e});module.exports={pkg:{dependencies:[]},init:function(t){var a,i,c,e,d=this;a=t.manager,i=t.data;c={amend:"需補正",accept:"符合",reject:"不符合"};this.activeProject=null;this.showProjectDetail=false;this.formCtx={data:{info:{},form:{}},prj:{}};this.formData={};e={ctx:this.formCtx,init:{"amend-date":function(t){var e,n,r;e=t.node,n=t.local,r=t.ctx;return a.from("@makeform/date",{root:e,data:{config:{display:"inline"}}}).then(function(t){n.itf=t["interface"];n.itf.value(r.data.info["amend-date"]);return t["interface"].on("change",function(t){r.data.info["amend-date"]=t;return d.update()})})},"notify-date":function(t){var e,n,r;e=t.node,n=t.local,r=t.ctx;return a.from("@makeform/date",{root:e,data:{config:{display:"inline"}}}).then(function(t){n.itf=t["interface"];n.itf.value(r.data.info["notify-date"]);return t["interface"].on("change",function(t){r.data.info["notify-date"]=t;return d.update()})})}},action:{click:{amend:function(t){var e,n,r,a;e=t.views,n=t.node,r=t.ctx;if(r.data.info.result!=="amend"){return}a=n.getAttribute("data-name");r.data.info.amend=a;e[0].render("amend");return d.update()},result:function(t){var e,n,r,a;e=t.views,n=t.node,r=t.ctx;a=n.getAttribute("data-name");r.data.info.result=a;if(a!=="amend"){r.data.info.amend=null}e[0].render(["result","amend"]);e[1].render();return d.update()},save:function(t){var e,n,r,a;e=t.ctx;n=i.brd;r=e.data.info.result==="accept";a={prjs:[{key:e.prj.key,badge:r}],badge:"criteria"};return ld$.fetch("/dash/api/brd/"+n+"/system/badge",{method:"POST"},{json:a}).then(function(){return console.log("done.")})}}},text:{name:function(t){var e;e=t.ctx;return e.prj.name},teamname:function(t){var e;e=t.ctx;return e.prj.teamname||e.prj.ownername||"n/a"},budget:function(t){var e;e=t.ctx;return 0},grant:function(t){var e;e=t.ctx;return 0},"self-financing":function(t){var e;e=t.ctx;return 0}},handler:{"amend-date":function(t){var e,n;e=t.local,n=t.ctx;if(e.itf){return e.itf.value(n.data.info["amend-date"])}},"notify-date":function(t){var e,n;e=t.local,n=t.ctx;if(e.itf){return e.itf.value(n.data.info["notify-date"])}},amend:function(t){var e,n,r,a;e=t.node,n=t.ctx;r=n.data.info.result!=="amend";e.classList.toggle("disabled",r);if(r){return}a=e.getAttribute("data-name");return e.classList.toggle("active",n.data.info.amend===a)},result:function(t){var e,n,r;e=t.node,n=t.ctx;r=e.getAttribute("data-name");return e.classList.toggle("active",n.data.info.result===r)},item:{list:function(){return items},key:function(t){return t.name},view:{action:{click:{check:function(t){var e,n,r,a,i,o,c,u;e=t.views,n=t.node,r=t.ctx,a=t.ctxs;i=n.getAttribute("data-name");o=((c=a[0].data.form)[u=r.name]||(c[u]={})).value===i?null:i;((c=a[0].data.form)[u=r.name]||(c[u]={})).value=o;e[0].render();return d.update()}},change:{note:function(t){var e,n,r,a,i;e=t.node,n=t.ctx,r=t.ctxs;((a=r[0].data.form)[i=n.name]||(a[i]={})).note=e.value;return d.update()}},input:{note:function(t){var e,n,r,a,i;e=t.node,n=t.ctx,r=t.ctxs;((a=r[0].data.form)[i=n.name]||(a[i]={})).note=e.value;return d.update()}}},text:{index:function(t){var e;e=t.ctx;return e.idx},name:function(t){var e;e=t.ctx;return e.name}},handler:{note:function(t){var e,n,r,a,i;e=t.node,n=t.ctx,r=t.ctxs;return e.value=((a=r[0].data.form)[i=n.name]||(a[i]={})).note||""},required:function(t){var e,n;e=t.node,n=t.ctx;e.classList.toggle("text-light",!n.required);return e.classList.toggle("text-danger",!!n.required)},check:function(t){var e,n,r,a,i,o,c,u;e=t.node,n=t.ctx,r=t.ctxs;a=e.getAttribute("data-name");i=e.getAttribute("data-name")===((o=r[0].data.form)[c=n.name]||(o[c]={})).value;u=a==="yes"?"bg-success":"bg-danger";e.classList.toggle(u,i);e.classList.toggle("text-white",i);return e.classList.toggle("text-light",!i)}}}}}};this.toggle=function(t,e){var n,r;e==null&&(e=true);this.activeProject=this.formCtx.prj=t;this.formCtx.data=(n=this.formData)[r=t.key]||(n[r]={});(n=this.formCtx.data).info||(n.info={});(n=this.formCtx.data).form||(n.form={});this.showProjectDetail=e;return this.view.render(["iframe","reader","form"])};return this.view=new ldview({initRender:false,root:document.body,action:{click:{publish:function(){var t,n,r,e,a;t=function(){var t,e=[];for(n in t=this.formData){r=t[n];e.push([n,r])}return e}.call(d).map(function(t){var e,n;e=t[0],n=t[1];return{key:+e,badge:(n.info||(n.info={})).result==="accept"}});e=i.brd;a={prjs:t,badge:"criteria"};return ld$.fetch("/dash/api/brd/"+e+"/system/badge",{method:"POST"},{json:a}).then(function(){return console.log("done.")})},"reader-close":function(t){var e;e=t.views;d.activeProject=d.formCtx.prj=null;d.formCtx.data={info:{},form:{}};return e[0].render(["reader","iframe"])}}},handler:{"progress-bar":function(t){var e,a,n;e=t.node;a=e.getAttribute("data-name");n=d.prjs.filter(function(t){var e,n,r;return c[((e=(n=d.formData)[r=t.key]||(n[r]={})).info||(e.info={})).result]===a}).length;return e.style.width=100*n/d.prjs.length+"%"},"progress-percent":function(t){var e,n;e=t.node;n=d.prjs.filter(function(t){var e,n,r;return!!c[((e=(n=d.formData)[r=t.key]||(n[r]={})).info||(e.info={})).result]}).length;return e.innerText=Math.floor(100*n/d.prjs.length)},count:function(t){var e,n,r;e=t.node;n=e.getAttribute("data-name");r=d.prjs.filter(function(t){var e,n,r;return!!c[((e=(n=d.formData)[r=t.key]||(n[r]={})).info||(e.info={})).result]}).length;if(n!=="done"){r=d.prjs.length-r}return e.innerText=r},form:e,reader:function(t){var e;e=t.node;return e.classList.toggle("d-none",!(d.activeProject&&d.showProjectDetail))},iframe:function(t){var e;e=t.node;if(!(d.activeProject&&d.showProjectDetail)){return}return e.setAttribute("src","/prj/"+d.activeProject.slug)},project:{list:function(){return d.prjs},key:function(t){return t.key},view:{action:{click:{edit:function(t){var e,n,r;e=t.node,n=t.views,r=t.ctx;d.toggle(r,false);return n[1].render("project")},name:function(t){var e,n,r;e=t.node,n=t.views,r=t.ctx;d.toggle(r,true);return n[1].render("project")}}},text:{idx:function(t){var e;e=t.ctx;return(e.system||(e.system={})).idx||"n/a"},name:function(t){var e;e=t.ctx;return e.name},ownername:function(t){var e,n,r;e=t.ctx;return((n=(r=(e.detail||(e.detail={})).custom).open||(r.open={}))["提案單位"]||(n["提案單位"]={})).v}},handler:{"@":function(t){var e,n;e=t.node,n=t.ctx;return e.classList.toggle("active",d.activeProject&&d.activeProject.slug===n.slug)},result:function(t){var e,n,r,a,i,o;e=t.node,n=t.ctx;r=((a=(i=d.formData)[o=n.key]||(i[o]={})).info||(a.info={})).result;e.classList.toggle("bg-danger",r==="reject");e.classList.toggle("bg-warning",r==="amend");e.classList.toggle("bg-success",r==="accept");e.classList.toggle("text-white",!!r);return e.innerText=c[r]||"未填"}}}}}})},interface:function(){var e=this;return{load:function(){},adapt:function(t){e.formData=t.data.prj;e.update=function(){return t.update()};e.prjs=t.prjs;return e.view.render()}}}};</script></div>