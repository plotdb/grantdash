function in$(r,t){for(var e=-1,n=t.length>>>0;++e<n;)if(r===t[e])return!0;return!1}function import$(r,t){var e={}.hasOwnProperty;for(var n in t)e.call(t,n)&&(r[n]=t[n]);return r}ldc.register("adminMenu",["sdbAdapter","loader"],function(r){var t,e;return t=r.sdbAdapter,r.loader,e=function(r){var t,e,n,i,o,d=this;return this.opt=r,this.toc=t=r.toc,this.grps=[],this.update=debounce(500,function(){return d.opsOut(function(){return d.grps})}),this.setGroup=e=function(t){return r.setGroup(t)},n=debounce(function(r){return t.brdsFiltered=t.brds.filter(function(t){return~t.name.indexOf(r)}),o.render(),o.get("brd-list").folder.fit()}),i=ld$.find("[ld-scope=admin-menu]",0),this.view=o=new ldView({root:i,action:{click:{"brd-bar":function(r){return r.node,o.get("brd-list").folder.toggle(),o.render("brd-list-toggle")},"grp-add":function(r){return r.node,d.addGroup()}},input:{"brd-search":function(r){var t;return t=r.node,n(t.value)}}},text:{"org-name":function(){return t.org.name},"brd-name":function(){return t.brd.name},"brd-progress-text":function(){return"活動進行中"}},init:{folder:function(r){var e,n;if(e=r.node,n=r.names,e.folder=new ldui.Folder({root:e}),!t.brd.key&&in$("brd-list",n))return e.folder.toggle(!0)}},handler:{"brd-page":function(r){var e,n;return e=r.node,"landing"===(n=e.getAttribute("data-name"))?e.setAttribute("href","/brd/"+t.brd.slug+"/"):"list"===n?e.setAttribute("href","/dash/brd/"+t.brd.slug+"/list"):"new-prj"===n?e.setAttribute("href","/dash/brd/"+t.brd.slug+"/prj/create"):void 0},"org-menu":function(r){return r.node.classList.toggle("d-none",!t.org.slug)},"brd-progress":function(r){return r.node.classList.toggle("text-success",!0)},"brd-list-toggle":function(r){var t;if(t=r.node,o)return t.classList.toggle("on",o.get("brd-list").classList.contains("show"))},brd:function(r){var e,n,i;return(e=r.node).classList.toggle("d-none",!(n=!t.brd.key)!=!(i=~e.getAttribute("ld").indexOf("empty"))&&(n||i))},brds:function(r){var e,n,i;return(e=r.node).classList.toggle("d-none",!(n=!t.brds.length)!=!(i=~e.getAttribute("ld").indexOf("empty"))&&(n||i))},"brd-entry":{list:function(){return t.brdsFiltered},handler:function(r){var t,e;return t=r.node,e=r.data,ld$.find(t,".text-truncate",0).innerText=e.name,ld$.find(t,".text-sm",0).innerText=e.description.substring(0,30)+"...",t.setAttribute("href","/dash/brd/"+e.slug+"/admin")}},"grp-entry":{key:function(r){return r.key},list:function(){return d.grps||[]},init:function(r){var t,n,i;return t=r.node,n=r.data,t.data=n,i=t,t.folder=new ldui.Folder({root:t}),t.view=new ldView({root:t,handler:{name:function(r){var t,e;return t=r.node,t.innerText=((e=i.data).info||(e.info={})).name||"新分組"}},action:{click:{"nav-tab":function(r){return r.node,e(n)}}}})},handler:function(r){var t,e;return t=r.node,e=r.data,t.data=e,t.view.render("name")}}}}),this},e.prototype=import$(import$(Object.create(Object.prototype),t.interface),{deleteGroup:function(r){var t;if((t=this.grps.filter(function(t){return t.key===r})[0])&&1!==this.grps.length)return this.grps.splice(this.grps.indexOf(t),1),this.setGroup(this.grps[0]),this.view.render("grp-entry"),this.update().now()},cloneGroup:function(r){var t;if(t=this.grps.filter(function(t){return t.key===r})[0])return t=JSON.parse(JSON.stringify(t)),t.key=suuid(),this.grps.push(t),this.view.render("grp-entry"),this.update().now()},addGroup:function(){var r,t;for(r=0;r<100&&(r,t=suuid(),this.grps.filter(function(r){return r.key===t}).length);++r);if(this.grps.filter(function(r){return r.key===t}).length)throw new ldError(1011);return this.grps.push({key:t,info:{name:"新分組"}}),this.view.render("grp-entry"),this.update().now()},opsIn:function(r){var t;return t=r.data,r.ops,r.source,this.grps=JSON.parse(JSON.stringify(t||[])),Array.isArray(t)||(this.grps=[]),this.view.render()}}),e});