function in$(r,t){for(var n=-1,e=t.length>>>0;++n<e;)if(r===t[n])return!0;return!1}function import$(r,t){var n={}.hasOwnProperty;for(var e in t)n.call(t,e)&&(r[e]=t[e]);return r}ldc.register("adminMenu",["sdbAdapter","loader"],function(r){var t,n;return t=r.sdbAdapter,r.loader,n=function(r){var t,n,e,i,o,d=this;return this.opt=r,this.toc=t=r.toc,this.grps=[],this.update=debounce(500,function(){return d.opsOut(function(){return d.grps})}),this.setGroup=n=function(t){return r.setGroup(t)},e=debounce(function(r){return t.brdsFiltered=t.brds.filter(function(t){return~t.name.indexOf(r)}),o.render(),o.get("brd-list").folder.fit()}),i=ld$.find("[ld-scope=admin-menu]",0),this.view=o=new ldView({root:i,action:{click:{"brd-bar":function(r){return r.node,o.get("brd-list").folder.toggle(),o.render("brd-list-toggle")},"grp-add":function(r){return r.node,d.addGroup()}},input:{"brd-search":function(r){var t;return t=r.node,e(t.value)}}},text:{"org-name":function(){return t.org.name},"brd-name":function(){return t.brd.name},"brd-progress-text":function(){return"活動進行中"}},init:{folder:function(r){var n,e;if(n=r.node,e=r.names,n.folder=new ldui.Folder({root:n}),!t.brd.key&&in$("brd-list",e))return n.folder.toggle(!0)}},handler:{"brd-landing":function(r){return r.node.setAttribute("href","/brd/"+t.brd.slug+"/")},"org-menu":function(r){return r.node.classList.toggle("d-none",!t.org.slug)},"brd-progress":function(r){return r.node.classList.toggle("text-success",!0)},"brd-list-toggle":function(r){var t;if(t=r.node,o)return t.classList.toggle("on",o.get("brd-list").classList.contains("show"))},brd:function(r){var n,e,i;return(n=r.node).classList.toggle("d-none",!(e=!t.brd.key)!=!(i=~n.getAttribute("ld").indexOf("empty"))&&(e||i))},brds:function(r){var n,e,i;return(n=r.node).classList.toggle("d-none",!(e=!t.brds.length)!=!(i=~n.getAttribute("ld").indexOf("empty"))&&(e||i))},"brd-entry":{list:function(){return t.brdsFiltered},handler:function(r){var t,n;return t=r.node,n=r.data,ld$.find(t,"span",0).innerText=n.name,ld$.find(t,".text-sm",0).innerText=n.description.substring(0,30)+"...",t.setAttribute("href","/b/"+n.slug+"/admin")}},"grp-entry":{key:function(r){return r.key},list:function(){return d.grps||[]},init:function(r){var t,e,i;return t=r.node,e=r.data,t.data=e,i=t,t.folder=new ldui.Folder({root:t}),t.view=new ldView({root:t,handler:{name:function(r){var t,n;return t=r.node,t.innerText=((n=i.data).info||(n.info={})).name||"新分組"}},action:{click:{"nav-tab":function(r){return r.node,n(e)}}}})},handler:function(r){var t,n;return t=r.node,n=r.data,t.data=n,t.view.render("name")}}}}),this},n.prototype=import$(import$(Object.create(Object.prototype),t.interface),{deleteGroup:function(r){var t;if((t=this.grps.filter(function(t){return t.key===r})[0])&&1!==this.grps.length)return this.grps.splice(this.grps.indexOf(t),1),this.setGroup(this.grps[0]),this.view.render("grp-entry"),this.update().now()},addGroup:function(){var r,t;for(r=0;r<100&&(r,t=suuid(),this.grps.filter(function(r){return r.key===t}).length);++r);if(this.grps.filter(function(r){return r.key===t}).length)throw new ldError(1011);return this.grps.push({key:t,info:{name:"新分組"}}),this.view.render("grp-entry"),this.update().now()},opsIn:function(r){var t;return t=r.data,r.ops,r.source,this.grps=JSON.parse(JSON.stringify(t||[])),Array.isArray(t)||(this.grps=[]),this.view.render()}}),n});