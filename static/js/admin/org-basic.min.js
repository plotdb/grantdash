function in$(n,t){for(var e=-1,r=t.length>>>0;++e<r;)if(n===t[e])return!0;return!1}function import$(n,t){var e={}.hasOwnProperty;for(var r in t)e.call(t,r)&&(n[r]=t[r]);return n}ldc.register("orgBasic",[],function(){var n,t,e,r,i,u,o,l,c;n={name:"布拉國",description:"告訴你一個神秘的地方..."},t=new ldLoader({className:"ldld full"}),e=new ldNotify({root:".ldNotify",classIn:["ld-fall-ttb-in"]}),r={},tail.DateTime("input[name=starttime]"),tail.DateTime("input[name=endtime]"),i=debounce(500,function(n,t,e){var i;return(i=ld$.parent(u.fields[n],".form-group")).classList.add("running"),ld$.fetch("/d/o/slug-check",{method:"POST"},{json:{slug:t},type:"json"}).finally(function(){return debounce(1e3).then(function(){return i.classList.remove("running")})}).then(function(n){return null==n&&(n={}),r[t]="free"!==n.result}).catch(function(){return r[t]=!0}).then(function(){return u.check({n:"slug"})})}),u=new ldForm({root:"[ld-scope='org-basic']",submit:"[ld='submit']",afterCheck:function(n,t){var e;if(t.thumbnail.value){if(!(e=ld$.parent(t.thumbnail,".bg")))return;ldFile.fromFile(t.thumbnail.files[0],"dataurl").then(function(n){return e.style.backgroundImage="url("+n.result+")"})}return n.all=["name","slug","description"].reduce(function(t,e){return t&&0===n[e]},!0)?0:2},verify:function(n,t,e){return c.update(n,t),in$(n,["slug"])?null!=r[t]?r[t]?2:0:(i(n,t,e),1):t?0:2}}),new ldView({root:"[ld-scope='org-basic']",action:{click:{submit:function(n){var r;return n.node,t.on(),r=u.getfd(),ld$.fetch("/d/o/",{method:"POST",body:r},{type:"json"}).then(function(n){return e.send("success","建立完成，將您導向組織主控台 ..."),debounce(1e3).then(function(){return window.location.href="/o/"+n.key+"/admin"})}).catch(function(){return debounce(1e3).then(function(){return t.off()})})}}}});for(o in n)l=n[o],u.fields[o].value=l;return c={install:function(t){return this.sdb=t.sdb,this.doc=t.doc,n=JSON.parse(JSON.stringify(this.doc.data)),this.watch(n)},update:function(t,e){var r,i;if(r=JSON.parse(JSON.stringify(n)),r[t]=e,console.log(n,r),(i=this.sdb.json.diff(n,r))&&i.length)return this.doc.submitOp(i)},watch:function(t){var e,r,i,o=[];import$(n,t);for(e in r=n)i=r[e],o.push(u.fields[e].value=i);return o}}}),ldc.app("orgBasic");