function import$(t,r){var e={}.hasOwnProperty;for(var n in r)e.call(r,n)&&(t[n]=r[n]);return t}ldc.register("adminJudgeFinal",["ldcvmgr","auth","sdbAdapter","error","adminPanel"],function(t){var r,e,n,a;return t.ldcvmgr,t.auth,r=t.sdbAdapter,e=t.error,n=t.adminPanel,a=function(t){var r=this;return null==t&&(t={}),this.opt=t,this.root="string"==typeof t.root?document.querySelector(t.root):t.root,this.path=t.path,this.brd=t.brd,this.grp=null,this.data={},this.obj={},n.on("active",function(t){var n,a;if(n=t.nav,a=t.name,t.panel,"grp-judge"===n&&"final"===a)return r.prepare().then(function(){return r.view.render()}).catch(e())}),this.view=new ldView({root:this.root,action:{click:{switch:function(t){var e,n;return e=t.node,n=e.getAttribute("data-name"),e.classList.toggle("on"),r.obj[n]=e.classList.contains("on"),r.update()}}},handler:{switch:function(t){var e,n;return e=t.node,n=e.getAttribute("data-name"),e.classList.toggle("on",!!r.obj[n])},"final-user-link":function(t){var e;if(e=t.node,r.grp)return e.setAttribute("href","/dash/brd/"+r.brd.slug+"/grp/"+r.grp.key+"/judge/final/user")},"final-all-link":function(t){var e;if(e=t.node,r.grp)return e.setAttribute("href","/dash/brd/"+r.brd.slug+"/grp/"+r.grp.key+"/judge/final/all")}}}),this},a.prototype=import$(import$(Object.create(Object.prototype),r.interface),{opsIn:function(t){var r;if(r=t.data,t.ops,!t.source)return this.obj=JSON.parse(JSON.stringify(r||{})),this.view.update()},update:function(){var t=this;return this.opsOut(function(){return t.obj})},prepare:function(){var t=this;return ld$.fetch("/dash/api/brd/"+this.brd.slug+"/grp/"+this.grp.key+"/judge/final/all",{method:"GET"},{type:"json"}).then(function(r){var e,n,a,i;return t.data=e=r||{},(n=(a=t.data).data||(a.data={})).user||(n.user={}),i=e.prjs,(e.users||[]).map(function(r){var n;return n=i.filter(function(n){var a,i,o,u,s,d,c;return a=(i=(o=(s=(d=e.data.user)[c=r.key]||(d[c]={})).prj||(s.prj={}))[u=n.key]||(o[u]={})).v||(i.v={}),!((i=(o=t.grp).grade||(o.grade={})).entries||(i.entries=[])).filter(function(t){return!(null!=a[t.key])||""===a[t.key]}).length}),r.percent=100*n.length/i.length})}).catch(e())},setData:function(t){var r=this;return this.grp=t,this.prepare().then(function(){return r.view.render()}).catch(e())}}),a});