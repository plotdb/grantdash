function import$(t,e){var r={}.hasOwnProperty;for(var n in e)r.call(e,n)&&(t[n]=e[n]);return t}ldc.register("adminPage",["auth","error","sdbAdapter","ldcvmgr"],function(t){var e,r,n,a;return e=t.auth,r=t.sdbAdapter,t.error,n=t.ldcvmgr,a=function(t){var r,a,i=this;if(this.type=r=~["org","brd"].indexOf(t.type)?t.type:null,!r)throw new ldError(1015,"admin-page: type is not defined.");return this.root=a="string"==typeof t.root?document.querySelector(t.root):t.root,this.toc=t.toc,this.data={},this.update=debounce(function(){return i._update()}),this.view=new ldView({root:a,action:{click:{deploy:function(){return e.recaptcha.get().then(function(t){var e;return e={slug:i.toc[i.type].slug,type:i.type,recaptcha:t},ld$.fetch("/dash/api/deploy",{method:"POST"},{json:e,type:"json"})}).then(function(){return n.toggle("deploying")}).catch(function(){return n.toggle("deploy-failed")})},opt:function(t){var e,r;return e=t.node,r=e.getAttribute("data-name"),i.data.opt=r,i.update().now(),i.view.render()},"git-secret-gen":function(){var t;return((t=i.data).git||(t.git={})).secret=i.view.get("git-secret").value=suuid(),i.update()}},input:{"git-url":function(t){var e,r;return e=t.node,((r=i.data).git||(r.git={})).url=e.value||"",i.update()},"custom-css-url":function(t){var e,r;return e=t.node,((r=i.data).generic||(r.generic={})).cssUrl=e.value||"",i.update()},"custom-landing-url":function(t){var e,r;return e=t.node,((r=i.data).generic||(r.generic={})).landingUrl=e.value||"",i.update()},"git-branch":function(t){var e,r;return e=t.node,((r=i.data).git||(r.git={})).branch=e.value||"",i.update()},"git-secret":function(t){var e,r;return e=t.node,((r=i.data).git||(r.git={})).secret=e.value||"",i.update()}}},handler:{"nav-panel":function(t){var e,r;return e=t.node,r=e.getAttribute("data-name"),e.classList.toggle("d-none",!((i.data.opt||"default")===r))},"git-url":function(t){var e,r;return e=t.node,e.value=((r=i.data).git||(r.git={})).url||""},"custom-css-url":function(t){var e,r;return e=t.node,e.value=((r=i.data).generic||(r.generic={})).cssUrl||""},"custom-landing-url":function(t){var e,r;return e=t.node,e.value=((r=i.data).generic||(r.generic={})).landingUrl||""},"git-branch":function(t){var e,r;return e=t.node,e.value=((r=i.data).git||(r.git={})).branch||""},"git-secret":function(t){var e,r;return e=t.node,e.value=((r=i.data).git||(r.git={})).secret||""},opt:function(t){var e,r,n;return e=t.node,r=e.getAttribute("data-name"),n=(i.data.opt||"default")===r,e.classList.toggle("btn-outline-secondary",!n),e.classList.toggle("btn-primary",n),e.innerHTML=n?"目前選項<i class='i-check'></i>":"使用這個選項"}}}),this},a.prototype=import$(import$(Object.create(Object.prototype),r.interface),{_update:function(){var t=this;return this.opsOut(function(){return t.data})},render:function(){return this.view.render()},opsIn:function(t){var e;if(e=t.data,t.ops,!t.source)return this.data=JSON.parse(JSON.stringify(e||{})),this.render()}}),a});