function import$(t,e){var n={}.hasOwnProperty;for(var r in e)n.call(e,r)&&(t[r]=e[r]);return t}ldc.register("adminJudgePerm",["ldcvmgr","auth","sdbAdapter","error"],function(t){var e,n,r,i;return t.ldcvmgr,e=t.auth,n=t.sdbAdapter,r=t.error,i=function(t){var n=this;return null==t&&(t={}),this.data={list:[]},this.opt=t,this.root="string"==typeof t.root?document.querySelector(t.root):t.root,this.brd=t.brd,this.grp=null,this.view=new ldView({root:this.root,action:{click:{add:function(){var t,i,o;if(t=n.view.get("name").value,i=n.view.get("email").value,t&&i&&!n.data.list.filter(function(e){return e.name===t||e.email===i}).length)return o={email:i,brd:n.brd.slug,grp:n.grp.key},n.ldbtn.on(),e.recaptcha.get().then(function(t){return o.recaptcha=t,ld$.fetch("/dash/api/judgetoken",{method:"POST"},{json:o,type:"json"})}).then(function(e){var r;return null==e&&(e={}),e.id&&e.token?(r=e.id+":1",n.data.list.push({name:t,email:i,token:e.token,id:r}),n.update(),n.view.render()):Promise.reject(new ldError(400))}).finally(function(){return n.ldbtn.off()}).catch(r())}}},init:{add:function(t){var e;return e=t.node,n.ldbtn=new ldLoader({root:e})}},handler:{empty:function(t){var e;return t.node.classList.toggle("d-none",((e=n.data).list||(e.list=[])).length)},judges:{list:function(){var t;return(t=n.data).list||(t.list=[])},init:function(t){var e,r,i;return e=t.node,r=t.data,i=t.local,e.classList.remove("d-none"),i.view=new ldView({root:e,context:r,action:{click:{delete:function(t){var e;return e=t.context,n.data.list.splice(n.data.list.indexOf(e),1),n.view.render(),n.update()}}},init:{copylink:function(t){var e,n;return e=t.node,n=t.local,n.clipboard=new ClipboardJS(e,{text:function(t){var e;return e=t.data,"https://"+window.location.hostname+"/dash/judgetoken/"+e.token+"#"+e.email}}),n.clipboard.on("success",function(){return clearTimeout(n.h),e.classList.add("tip-on"),n.h=setTimeout(function(){return e.classList.remove("tip-on")},1e3)})}},handler:{copylink:function(t){var e,n;return e=t.node,n=t.context,e.data=n}},text:{name:function(t){return t.context.name},email:function(t){return t.context.email}}})},handler:function(t){var e,n;return e=t.local,n=t.data,e.view.setContext(n),e.view.render()}}}}),this},i.prototype=import$(import$(Object.create(Object.prototype),n.interface),{update:function(){var t=this;return this.opsOut(function(){return t.data})},setData:function(t){return this.grp=t,this.view.render()},updateView:function(){return this.view.render()},opsIn:function(t){var e,n;if(e=t.data,t.ops,!t.source)return this.data=JSON.parse(JSON.stringify(e||{})),(n=this.data).list||(n.list=[]),this.updateView()}}),i});