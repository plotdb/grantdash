ldc.register("admin",["viewLocals","orgInfo","orgPerm","brdInfo","prjInfo","loader"],function(o){var n,r,e,t,d,c,i,a,u,f,p,l,s;return o.viewLocals,n=o.orgInfo,r=o.orgPerm,e=o.brdInfo,t=o.prjInfo,(d=o.loader).on(),c={},(i=new sharedbWrapper({url:{scheme:window.location.protocol.replace(":",""),domain:window.location.host}})).on("close",function(){return d.on(),i.reconnect().then(function(){return p()}).then(function(){return d.off()})}),a=function(o,e){return n.watch({ops:o,source:e}),r.watch({ops:o,source:e})},(u=/o\/([0-9]+)/.exec(window.location.pathname))&&(f="org-"+(u?u[1]:"demo"),(p=function(){return d.on(),i.get({id:f,watch:a}).then(function(o){return c.doc=o,console.log(o.data),n.init({doc:o,sdb:i}),r.init({doc:o,sdb:i}),d.off()})})()),l=new ldView({initRender:!1,root:".project-groups",action:{click:{"project-group-add":function(o){var n,r;return o.node,((n=JSON.parse(JSON.stringify(c.docbrd.data))).group||(n.group=[])).push({key:(n.group||(n.group=[])).length+1,name:"新分組"}),r=i.json.diff(c.docbrd.data,n),c.docbrd.submitOp(r),l.render()}}},handler:{"project-group":{list:function(){return c.docbrd.data.group||[]},handler:function(o){var n,r,e;return n=o.node,r=o.data,e=ld$.find(n,"[ld=name]",0),e.innerText=r.name,new ldui.Folder({root:n}),new ldui.Nav(n)}}}}),s=function(o,n){return e.watch({ops:o,source:n}),t.watch({ops:o,source:n})},(u=/b\/([0-9]+)/.exec(window.location.pathname))&&(f="board-"+(u?u[1]:"demo"),function(){return d.on(),i.get({id:f,watch:s}).then(function(o){return c.docbrd=o,e.init({doc:c.docbrd,sdb:i}),t.init({doc:c.docbrd,sdb:i}),l.render(),d.off()})}()),d.off()}),ldc.app("admin");