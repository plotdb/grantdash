function import$(r,n){var e={}.hasOwnProperty;for(var t in n)e.call(n,t)&&(r[t]=n[t]);return r}ldc.register("adminGuard",["auth","loader"],function(r){var n,e,t;return n=r.auth,(e=r.loader).on(),n.ensure().then(function(){var r,n,e,o;return r=/^\/([ob])\/([^/]+)\/admin/.exec(window.location.pathname)||[],r[0],n=r[1],e=r[2],o=import$({},n?"o"===n?{org:e}:{brd:e}:{}),ld$.fetch("/d/toc/",{method:"POST"},{json:o,type:"json"}).catch(function(){return lda.ldcvmgr.lock("create-brd-now")}).then(function(r){return t(r)}).catch(function(r){return console.log(r),lda.ldcvmgr.toggle("error")})}).catch(function(){return lda.ldcvmgr.toggle("auth-required")}),t=function(r){var n,t,o;return r.org=r.org||{},r.brd=r.brd||{},r.brds=r.brds||[],r.brdsFiltered=r.brds||[],n=debounce(function(n){return r.brdsFiltered=r.brds.filter(function(r){return~r.name.indexOf(n)}),o.render(),o.get("brd-list").folder.fit()}),console.log(r),t=ld$.find("[ld-scope=admin-menu]",0),o=new ldView({root:t,action:{click:{brd:function(r){var n,e;return n=r.node,e=o.get("brd-list").folder.toggle(),n.classList.toggle("on",e)}},input:{"brd-search":function(r){var e;return e=r.node,n(e.value)}}},text:{"org-name":function(){return r.org.name},"brd-name":function(){return r.brd.name},"brd-progress-text":function(){return"活動進行中"}},init:{folder:function(r){var n;return n=r.node,n.folder=new ldui.Folder({root:n})}},handler:{"org-menu":function(n){return n.node.classList.toggle("d-none",!r.org.key)},"brd-progress":function(r){return r.node.classList.toggle("text-success",!0)},brd:function(n){var e,t,o;return(e=n.node).classList.toggle("d-none",!(t=!r.brd.key)!=!(o=~e.getAttribute("ld").indexOf("empty"))&&(t||o))},brds:function(n){var e,t,o;return(e=n.node).classList.toggle("d-none",!(t=!r.brds.length)!=!(o=~e.getAttribute("ld").indexOf("empty"))&&(t||o))},"brd-entry":{list:function(){return r.brdsFiltered},action:{click:function(n){var e;return n.node,e=n.data,r.brd=e,o.render()}},handler:function(r){var n,e;return n=r.node,e=r.data,ld$.find(n,"span",0).innerText=e.name,ld$.find(n,".text-sm",0).innerText=e.description}}}}),e.off()}}),ldc.app("adminGuard");