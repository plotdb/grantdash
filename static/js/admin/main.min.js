function import$(n,r){var e={}.hasOwnProperty;for(var t in r)e.call(r,t)&&(n[t]=r[t]);return n}ldc.register("adminGuard",["auth","loader","adminPanel"],function(n){var r,e,t,o,d;return r=n.auth,e=n.loader,n.adminPanel,e.on(),r.ensure().then(function(){var n,r,e,o;return n=/^\/([ob])\/([^/]+)\/admin/.exec(window.location.pathname)||[],n[0],r=n[1],e=n[2],o=import$({},r?"o"===r?{org:e}:{brd:e}:{}),ld$.fetch("/d/toc/",{method:"POST"},{json:o,type:"json"}).catch(function(){return lda.ldcvmgr.lock("create-brd-now")}).then(function(n){return t(n)}).catch(function(n){return console.log(n),lda.ldcvmgr.toggle("error")})}).catch(function(){return lda.ldcvmgr.toggle("auth-required")}),t=function(n){return["org","brd","brds","brdsFiltered","grps"].map(function(r){return n[r]=n[r]||[]}),n.brdsFiltered=n.brds||[],d(n),o(n)},o=function(n){},d=function(n){var r,t,o,d;return r=function(n){},t=debounce(function(r){return n.brdsFiltered=n.brds.filter(function(n){return~n.name.indexOf(r)}),d.render(),d.get("brd-list").folder.fit()}),o=ld$.find("[ld-scope=admin-menu]",0),d=new ldView({root:o,action:{click:{"brd-bar":function(n){return n.node,d.get("brd-list").folder.toggle(),d.render("brd-list-toggle")}},input:{"brd-search":function(n){var r;return r=n.node,t(r.value)}}},text:{"org-name":function(){return n.org.name},"brd-name":function(){return n.brd.name},"brd-progress-text":function(){return"活動進行中"}},init:{folder:function(n){var r;return r=n.node,r.folder=new ldui.Folder({root:r})}},handler:{"org-menu":function(r){return r.node.classList.toggle("d-none",!n.org.key)},"brd-progress":function(n){return n.node.classList.toggle("text-success",!0)},"brd-list-toggle":function(n){var r;if(r=n.node,d)return r.classList.toggle("on",d.get("brd-list").classList.contains("show"))},brd:function(r){var e,t,o;return(e=r.node).classList.toggle("d-none",!(t=!n.brd.key)!=!(o=~e.getAttribute("ld").indexOf("empty"))&&(t||o))},brds:function(r){var e,t,o;return(e=r.node).classList.toggle("d-none",!(t=!n.brds.length)!=!(o=~e.getAttribute("ld").indexOf("empty"))&&(t||o))},"brd-entry":{list:function(){return n.brdsFiltered},action:{click:function(r){var e;return r.node,e=r.data,n.brd=e,d.render()}},handler:function(n){var r,e;return r=n.node,e=n.data,ld$.find(r,"span",0).innerText=e.name,ld$.find(r,".text-sm",0).innerText=e.description}},"grp-entry":{list:function(){return n.grps||[]},init:function(n){var e,t;return e=n.node,t=n.data,e.folder=new ldui.Folder({root:e}),e.view=new ldView({root:e,handler:{name:function(n){var r;return r=n.node,r.innerText=t.name}},action:{click:{"nav-tab":function(n){return n.node,r()}}}})},handler:function(n){var r;return r=n.node,n.data,r.view.render("name")}}}}),e.off()}}),ldc.app("adminGuard");