function import$(t,e){var n={}.hasOwnProperty;for(var o in e)n.call(e,o)&&(t[o]=e[o]);return t}ldc.register("adminPostList",["loader","ldcvmgr","error","adminPanel"],function(t){var e,n,o,r,i;return e=t.loader,n=t.ldcvmgr,o=t.error,r=t.adminPanel,i=function(t){var e,n=this;return this.opt=t,this.root=e="string"==typeof t.root?document.querySelector(t.root):t.root,this.brd=t.brd,this.posts=[],this.view={},this.ldcv={},this.ldld=new ldLoader({root:ld$.find(e,"[ld=loading]",0)}),this.view.list=new ldView({initRender:!1,root:this.root,action:{click:{"new-post":function(){return n.toggleModal()}}},handler:{empty:function(t){return t.node.classList.toggle("d-none",n.posts&&n.posts.length)},editor:function(t){return t.node.classList.toggle("d-none",!0)},post:{list:function(){return n.posts||[]},init:function(t){var e,o,r;return e=t.node,o=t.local,r=t.data,e.classList.remove("d-none"),o.view=new ldView({root:e,context:r,action:{click:{edit:function(t){var e;return t.node,e=t.context,n.edit(e.slug)}}},handler:{title:function(t){var e,n;return e=t.node,n=t.context,e.innerText=n.title},owner:function(t){var e,n;return e=t.node,n=t.context,e.innerText=n.ownername},date:function(t){var e,n;return e=t.node,n=t.context,e.innerText=moment(n.createdtime).format("YYYY-MM-DD hh:mm:ss")},avatar:function(t){var e,n;return e=t.node,n=t.context,e.style.backgroundImage="url(/s/avatar/"+n.owner+".png)"},view:function(t){var e,n;return e=t.node,n=t.context,e.setAttribute("href","/post/"+n.slug+"/")}}})},handler:function(t){var e,n;return e=t.local,n=t.data,e.view.setContext(n),e.view.render()}}}}),r.on("active",function(t){var e;if(t.nav,e=t.name,t.panel,"brd-post-list"===e)return n.edit(null),n.fetch()}),this},i.prototype=import$(Object.create(Object.prototype),{render:function(){return this.view.list.render()},fetch:function(){var t=this;return this.ldld.on(),ld$.fetch("/dash/api/post/",{method:"GET"},{params:{brd:this.brd.slug},type:"json"}).then(function(e){return t.posts=e,t.render(),t.ldld.off()})},edit:function(t){var e;return e=this.view.list.get("editor"),t&&(e.src="/dash/post/"+t+"/edit"),e.classList.toggle("d-none",!t)},toggleModal:function(){var t,r=this;return(t=this.ldcv.newPost)&&t.toggle(),n.getdom("new-post").then(function(t){return r.form=new ldForm({root:t,submit:"[ld=post]"}),r.view.create=new ldView({root:t,action:{click:{post:function(t){var n;return t.node,e.on(),n={brd:r.brd.slug,title:r.form.values().title},ld$.fetch("/dash/api/post/",{method:"POST"},{json:n,type:"json"}).then(function(t){return r.edit(t.slug),e.off(),r.ldcv.newPost.toggle(!1)}).catch(o())}}}}),n.getcover("new-post")}).then(function(t){return r.ldcv.newPost=t}).then(function(){return r.ldcv.newPost.toggle()})}}),i});