function import$(t,i){var a={}.hasOwnProperty;for(var n in i)a.call(i,n)&&(t[n]=i[n]);return t}var slice$=[].slice;!function(){var t;window.Adopter=t=function(){return this.doc=null,this.sdb=null,this.data=null,this.evtHandler={},this},t.prototype=import$(Object.create(Object.prototype),{on:function(t,i){var a;return((a=this.evtHandler)[t]||(a[t]=[])).push(i)},fire:function(t){var i,a,n,r,s,e=[];for(i=slice$.call(arguments,1),a=0,r=(n=this.evtHandler[t]||[]).length;a<r;++a)s=n[a],e.push(s.apply(this,i));return e},install:function(t){return this.sdb=t.sdb,this.doc=t.doc,this.data=this.doc.data,this.watch({data:this.data})},updateField:function(t,i){var a,n;return a=JSON.parse(JSON.stringify(this.data)),a[t]=i,n=this.sdb.json.diff(this.data,a),this.update(n),this.data[t]=i},update:function(t){if(t&&t.length)return this.doc.submitOp(t)},watch:function(t){var i,a;return i=t.ops,(a=t.data)&&(this.data=a),this.fire("change",{ops:i,data:a})}})}();