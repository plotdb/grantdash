function import$(t,i){var a={}.hasOwnProperty;for(var r in i)a.call(i,r)&&(t[r]=i[r]);return t}var slice$=[].slice;!function(){var t;window.Adopter=t=function(t){return null==t&&(t={}),this.doc=null,this.sdb=null,this.data=null,this.evtHandler=JSON.parse(JSON.stringify({})),this.path=t.path||[],this},t.prototype=import$(Object.create(Object.prototype),{on:function(t,i){var a;return((a=this.evtHandler)[t]||(a[t]=[])).push(i)},fire:function(t){var i,a,r,n,s,h=[];for(i=slice$.call(arguments,1),a=0,n=(r=this.evtHandler[t]||[]).length;a<n;++a)s=r[a],h.push(s.apply(this,i));return h},init:function(t){var i,a,r,n;for(this.sdb=t.sdb,this.doc=t.doc,i=this.doc.data,a=0,n=(r=this.path).length;a<n;++a)i=i[r[a]];return this.watch({data:i})},update:function(t){var i,a=this;if(this.sdb)return"function"==typeof t?(i=t(JSON.parse(JSON.stringify(this.data||{}))),t=this.data?[]:[{p:[],oi:{}}],t=t.concat(this.sdb.json.diff(this.data||{},i)),this.update(t)):Array.isArray(t)&&t.length?(t.map(function(t){return t.p=a.path.concat(t.p)}),this.doc.submitOp(t)):void 0},watch:function(t){var i,a,r,n,s,h,e;if(i=t.ops,a=t.data,r=t.source,a)this.data=a;else{for(n=this.doc.data,s=0,e=(h=this.path).length;s<e;++s)n=n[h[s]];this.data=n}return this.fire("change",{ops:i,data:a,source:r})}})}();