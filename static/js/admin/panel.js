// Generated by LiveScript 1.3.0
var slice$ = [].slice;
ldc.register('adminPanel', [], function(){
  var panel, api;
  panel = {
    inited: false,
    nav: {},
    cur: {},
    tab: {},
    toggle: function(arg$){
      var nav, name, tab, that, ref$, panel;
      nav = arg$.nav, name = arg$.name, tab = arg$.tab;
      if (that = ((ref$ = this.nav)[nav] || (ref$[nav] = {})).tab) {
        that.classList.toggle('active', false);
      }
      if (that = ((ref$ = this.nav)[nav] || (ref$[nav] = {})).panel) {
        that.classList.toggle('d-none', true);
      }
      panel = ld$.find("[ld~=nav-panel][data-nav=" + nav + "][data-name=" + name + "]", 0);
      ((ref$ = this.nav)[nav] || (ref$[nav] = {})).panel = panel;
      if (tab) {
        ((ref$ = this.nav)[nav] || (ref$[nav] = {})).tab = tab;
        tab.classList.toggle('active', true);
      }
      if (panel) {
        panel.classList.toggle('d-none', false);
      }
      if (nav === 'main') {
        ref$ = this.cur;
        ref$.nav = nav;
        ref$.name = name;
        ref$.func = this.tab[this.cur.name];
      } else {
        this.cur.func = this.tab[this.cur.name] = name;
      }
      return api.fire('active', {
        nav: nav,
        name: name,
        panel: panel
      });
    },
    init: function(){
      var this$ = this;
      if (this.inited) {
        return;
      }
      this.inited = true;
      ld$.find('[ld~=nav-panel]').map(function(it){
        var isDefault, nav, ref$;
        isDefault = in$('default', (it.getAttribute('ld') || '').split(' '));
        nav = it.getAttribute('data-nav');
        it.classList.toggle('d-none', !isDefault);
        if (isDefault) {
          ((ref$ = this$.nav)[nav] || (ref$[nav] = {})).panel = it;
        }
        return it.classList.add('ld', 'ld-float-ltr-in', 'xp15');
      });
      ld$.find('[ld~=nav-tab]').map(function(it){
        var isDefault, nav, p, ref$;
        isDefault = in$('default', (it.getAttribute('ld') || '').split(' '));
        nav = it.getAttribute('data-nav');
        it.style.transition = "all .15s ease-in-out";
        if (!nav && (p = ld$.parent(it, '[data-nav]'))) {
          nav = p.getAttribute('data-nav');
        }
        it.classList.toggle('active', isDefault);
        if (isDefault) {
          ((ref$ = this$.nav)[nav] || (ref$[nav] = {})).tab = it;
          return this$.tab[nav] = it.getAttribute('data-name');
        }
      });
      document.body.addEventListener('click', function(e){
        var n, tab, nav, p, name;
        if (!((n = e.target) && n.getAttribute)) {
          return;
        }
        if (!(tab = ld$.parent(n, '[ld~=nav-tab]'))) {
          return;
        }
        nav = tab.getAttribute('data-nav');
        if (!nav && (p = ld$.parent(tab, '[data-nav]'))) {
          nav = p.getAttribute('data-nav');
        }
        name = tab.getAttribute('data-name');
        return this$.toggle({
          nav: nav,
          name: name,
          tab: tab
        });
      });
      return ld$.find('.admin-sidemenu .folder').map(function(it){
        return new ldui.Folder({
          root: it
        });
      });
    }
  };
  panel.init();
  return api = {
    evtHandler: {},
    on: function(n, cb){
      var ref$;
      return ((ref$ = this.evtHandler)[n] || (ref$[n] = [])).push(cb);
    },
    toggle: function(arg$){
      var nav, name, tab;
      nav = arg$.nav, name = arg$.name, tab = arg$.tab;
      return panel.toggle({
        nav: nav,
        name: name,
        tab: tab
      });
    },
    fire: function(n){
      var v, i$, ref$, len$, cb, results$ = [];
      v = slice$.call(arguments, 1);
      for (i$ = 0, len$ = (ref$ = this.evtHandler[n] || []).length; i$ < len$; ++i$) {
        cb = ref$[i$];
        results$.push(cb.apply(this, v));
      }
      return results$;
    }
  };
});
function in$(x, xs){
  var i = -1, l = xs.length >>> 0;
  while (++i < l) if (x === xs[i]) return true;
  return false;
}