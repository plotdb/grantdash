function import$(n,t){var e={}.hasOwnProperty;for(var r in t)e.call(t,r)&&(n[r]=t[r]);return n}var slice$=[].slice;ldc.register("adminPrjList",["error","loader","notify","ldcvmgr","auth","sdbAdapter","adminPanel"],function(n){var t,e,r,a;return t=n.error,n.loader,e=n.notify,n.ldcvmgr,n.auth,n.sdbAdapter,r=n.adminPanel,a=function(n){var a=this;return this.toc=n.toc,this.evtHandler={},this.data=[],r.on("active",function(n){var e;if(n.nav,e=n.name,n.panel,"grp-list"===e)return ld$.fetch("/dash/api/brd/"+a.toc.brd.slug+"/list",{method:"GET"},{type:"json"}).then(function(n){return a.data=n,a.data.map(function(n){return n.info=n.detail.info}),a.view.render()}).catch(t())}),this.view=new ldView({root:n.root,handler:{empty:function(n){return n.node.classList.toggle("d-none",a.data.filter(function(n){return n.slug}).length)},prj:{list:function(){return a.data.filter(function(n){return n.slug})},init:function(n){var i,o,c;return i=n.node,o=n.local,c=n.data,o.view=new ldView({context:c,root:i,action:{click:{delete:function(n){var r,i;if(r=n.node,i=n.context,!r.classList.contains("running"))return r.classList.toggle("running",!0),ld$.fetch("/dash/api/prj/"+i.slug,{method:"delete"},{type:"json"}).finally(function(){return r.classList.toggle("running",!1)}).then(function(){var n;return e.send("success","成功刪除了「"+i.name+"」提案"),~(n=a.data.indexOf(i))&&a.data.splice(n,1),a.view.render()}).catch(t())},name:function(n){var t;return n.node,t=n.context,r.toggle({nav:"main",name:"grp-detail"}),a.setPrj(t)}}},text:{name:function(n){return n.context.name},index:function(n){return n.context.key},ownername:function(n){var t;return((t=n.context).info||(t.info={})).teamname||t.ownername||""},username:function(n){return n.context.ownername||""}},handler:{"budget-consume":function(n){n.node,n.context},"budget-detail":function(n){n.node,n.context},avatar:function(n){var t,e;return t=n.node,e=n.context,t.style.background="url(/s/avatar/"+e.owner+".png)"}}})}}}}),this},a.prototype=import$(Object.create(Object.prototype),{setPrj:function(n){return this.fire("set-prj",n)},on:function(n,t){var e;return((e=this.evtHandler)[n]||(e[n]=[])).push(t)},fire:function(n){var t,e,r,a,i,o=[];for(t=slice$.call(arguments,1),e=0,a=(r=this.evtHandler[n]||[]).length;e<a;++e)i=r[e],o.push(i.apply(this,t));return o}}),a});