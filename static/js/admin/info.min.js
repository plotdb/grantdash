function in$(t,n){for(var r=-1,e=n.length>>>0;++r<e;)if(t===n[r])return!0;return!1}function import$(t,n){var r={}.hasOwnProperty;for(var e in n)r.call(n,e)&&(t[e]=n[e]);return t}ldc.register("adminInfo",["loader","notify","ldcvmgr","auth","sdbAdapter"],function(t){var n,r,e,o,u;return n=t.loader,t.notify,r=t.ldcvmgr,e=t.auth,o=t.sdbAdapter,u=function(t){var o,u,i,a,l,c,d,f,s=this;if(this.opt=t,this.type=o={org:"o",prj:"p",brd:"b",grp:"g"}[t.type]||null,!o)throw new ldError(1015,"admin-info: type is not defined.");return this.root=u="string"==typeof t.root?document.querySelector(t.root):t.root,this.data=t.data,i={},a=debounce(500,function(t,n,r){var e;return(e=ld$.parent(c.fields[t],".form-group")).classList.add("running"),ld$.fetch("/d/slug-check/"+o,{method:"POST"},{json:{slug:n},type:"json"}).finally(function(){return debounce(1e3).then(function(){return e.classList.remove("running")})}).then(function(t){return null==t&&(t={}),i[n]="free"!==t.result}).catch(function(){return i[n]=!0}).then(function(){return c.check({n:"slug"})})}),l=(this.data||{}).slug,this.form=c=new ldForm({root:u,values:l?{slug:l}:{},submit:"[ld=submit]",afterCheck:function(t,n){var r,e;if(n.thumbnail&&n.thumbnail.value){if(!(r=ld$.parent(n.thumbnail,".bg")))return;ldFile.fromFile(n.thumbnail.files[0],"dataurl").then(function(t){return r.style.backgroundImage="url("+t.result+")"})}return e=["name","slug","description","brd","grp"].filter(function(t){return n[t]}),["brd","grp"].map(function(r){return t[r]=n[r]&&n[r].value?0:2}),t.all=e.reduce(function(n,r){return n&&0===t[r]},!0)?0:2},verify:function(t,n,r){return in$(t,["slug"])||s.opsOut(function(r){return r[t]=n,r}),in$(t,["slug"])?/^[a-zA-Z0-9-]+$/.exec(n)?null!=i[n]?i[n]?2:0:(a(t,n,r),1):2:n?0:2}}),d={},f=new ldView({root:u,init:{"tail-datetime":function(t){var n;return n=t.node,tail.DateTime(n)},orgs:function(){var t;return t={type:"org"},e.get().then(function(n){return ld$.fetch("/d/me/list/",{method:"POST"},{json:t,type:"json"})}).then(function(t){return d.list=t,f.render()}).catch(function(t){return console.log(t)})}},handler:{org:{key:function(t){return t.key},list:function(){return(d.list||[]).concat([{name:"ç„¡",key:null}])},handler:function(t){var n,r;return n=t.node,r=t.data,n.innerText=r.name+(r.slug?" ( "+r.slug+" )":""),n.setAttribute("value",r.key||"")}}},action:{click:{delete:function(){var t,n;if("group"===(t=s.adapter.path)[0]&&1!==((n=s.adapter.doc.data).group||(n.group=[])).length)return s.adapter.doc.submitOp([{p:["group",t[1]],od:s.adapter.doc.data.group[t[1]]}]),s.setPath(["group",0,"info"]),s.opt.setGroup(s.adapter.doc.data.group[0])},submit:function(t){if(!t.node.classList.contains("disabled"))return e.ensure().then(function(){var t;return n.on(),t=c.getfd(),ld$.fetch("/d/"+o+"/",{method:"POST",body:t},{type:"json"}).then(function(t){return n.off(),r.toggle("redirect"),debounce(1e3).then(function(){return window.location.href="p"===o?"/p/"+t.slug+"/edit":"/"+o+"/"+c.values().slug+"/admin"})}).catch(function(){return n.off(),r.toggle("error")})}).catch(function(){return lda.ldcvmgr.toggle("auth-required")})}}}}),this},u.prototype=import$(import$(Object.create(Object.prototype),o.interface),{opsIn:function(t){var n,r,e,o=[];if(n=t.data,t.ops,!t.source){for(r in e=this.form.fields)e[r],in$(r,["slug"])||o.push(this.form.fields[r].value=n[r]||"");return o}}}),u});