function in$(t,r){for(var n=-1,e=r.length>>>0;++n<e;)if(t===r[n])return!0;return!1}function import$(t,r){var n={}.hasOwnProperty;for(var e in r)n.call(r,e)&&(t[e]=r[e]);return t}ldc.register("adminInfo",["loader","notify","ldcvmgr","auth","sdbAdapter"],function(t){var r,n,e,o,u,i;return r=t.loader,n=t.notify,e=t.ldcvmgr,o=t.auth,u=t.sdbAdapter,i=function(t){var u,i,a,c,d,l=this;return this.opt=t,this.type=u="org"===t.type?"o":"b",this.root=i="string"==typeof t.root?document.querySelector(t.root):t.root,a={},c=debounce(500,function(t,r,n){var e;return(e=ld$.parent(d.fields[t],".form-group")).classList.add("running"),ld$.fetch("/d/slug-check/"+u,{method:"POST"},{json:{slug:r},type:"json"}).finally(function(){return debounce(1e3).then(function(){return e.classList.remove("running")})}).then(function(t){return null==t&&(t={}),a[r]="free"!==t.result}).catch(function(){return a[r]=!0}).then(function(){return d.check({n:"slug"})})}),this.form=d=new ldForm({root:i,submit:"[ld=submit]",afterCheck:function(t,r){var n;if(r.thumbnail&&r.thumbnail.value){if(!(n=ld$.parent(r.thumbnail,".bg")))return;ldFile.fromFile(r.thumbnail.files[0],"dataurl").then(function(t){return n.style.backgroundImage="url("+t.result+")"})}return t.all=["name","slug","description"].reduce(function(r,n){return r&&0===t[n]},!0)?0:2},verify:function(t,r,n){return l.opsOut(function(n){return n[t]=r,n}),in$(t,["slug"])?/^[a-zA-Z0-9-]+$/.exec(r)?null!=a[r]?a[r]?2:0:(c(t,r,n),1):2:r?0:2}}),new ldView({root:i,init:{"tail-datetime":function(t){var r;return r=t.node,tail.DateTime(r)}},action:{click:{delete:function(){var t,r,n,e;if("group"===(t=l.adapter.path)[0]){n=[];for(e in l.adapter.doc.data.group)n.push(e);if(1!==(r=n).length)return l.adapter.doc.submitOp([{p:["group",t[1]],od:l.adapter.doc.data.group[t[1]]}]),l.setPath(["group",r[0],"info"]),l.opt.setGroup(l.adapter.doc.data.group[r[0]])}},submit:function(t){return t.node,o.ensure().then(function(){var t;return r.on(),t=d.getfd(),ld$.fetch("/d/"+u+"/",{method:"POST",body:t},{type:"json"}).then(function(t){return n.send("success","建立完成，將您導向主控台 ..."),debounce(1e3).then(function(){return window.location.href="/"+u+"/"+d.values().slug+"/admin"})}).catch(function(){return r.off(),e.toggle("error")})}).catch(function(){return lda.ldcvmgr.toggle("auth-required")})}}}}),this},i.prototype=import$(import$(Object.create(Object.prototype),u.interface),{opsIn:function(t){var r,n,e,o=[];if(r=t.data,t.ops,!t.source){for(n in e=this.form.fields)e[n],o.push(this.form.fields[n].value=r[n]||"");return o}}}),i});