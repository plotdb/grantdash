function in$(t,e){for(var n=-1,r=e.length>>>0;++n<r;)if(t===e[n])return!0;return!1}var reblockDesign;reblockDesign={apply:function(t){return otJson0.type.apply(this.data,t[0])},submit:function(t){return console.log(t),console.log(this.data)},watch:function(t){},getHost:function(t){var e,n;for("string"==typeof t&&(t=(this.getBind(t)||{}).node),e=0;e<100;++e){if(e,!t)return null;if(n=this.getBind(t)){if(n.block)return n;if(n.host)return n.host}t=t.parentNode}},getBind:function(t){return"string"==typeof t?this.binding[t]:t.reblock?this.binding[t.reblock.id]:null},bind:function(t){var e,n,r,i,o;return e=t.node,n=t.data,r=t.block,i=e.reblock&&e.reblock.id?i:n.id||Math.random().toString(36).substring(2),n.id||(n.id=i),o=this.getHost(e.parentNode),this.binding[n.id]={node:e,data:n,host:o,block:r},e.setAttribute&&e.setAttribute("rbid",n.id),(e.reblock||(e.reblock={})).id=n.id},inject:function(t){var e,n,r,i,o,d,a,c,l=this;return e=t.host,n=t.sibling,t.dir,r=t.name,i=t.data,o=t.recurse,d=t.block,i||(i={type:"block",name:r,data:{}}),r||(r=i.name),n&&(e||(e=ld$.parent(n,"[editable]")),a=ld$.parent(n,"[editable] > *",e)),c={data:i},new Promise(function(t,n){return"block"!==i.type?n(new Error("incorrect data type")):(r?/^int:/.exec(r)?Promise.resolve(d.subblock[r]):l.blockmgr.get(r):Promise.resolve('<div editable="blocks"></div>')).then(function(t){var n,r,d,u,s,b,f,h,g;if("string"==typeof t?(c.node=n=document.createElement("div"),n.innerHTML=t,1===n.childNodes.length&&(n=n.childNodes[0]).parentNode.removeChild(n)):t instanceof Element?c.node=n=t.cloneNode(!0):Promise.reject(new Error("unrecognized block data")),e&&e.insertBefore(n,a),!o&&l.opt.transition&&(r=window.getComputedStyle(n),d=r.height,(u=n.style).height="0px",u.transition="height .15s ease-in-out",setTimeout(function(){return n.style.height=d},0),debounce(150).then(function(){return n.style.transition="",n.style.height=""})),l.bind({node:n,data:i,block:!0}),s=l.prepare({node:n,data:i}),l.construct({node:n,data:i,block:s}),b=l.getHost(e),!o&&b)return f=Array.from(e.childNodes).indexOf(n),((h=b.data.data)[g=e.getAttribute("editable")]||(h[g]=[])).splice(f,0,i)}).then(function(){return t(c)}).catch(function(t){return n(t)})})},prepare:function(t){var e,n,r,i;return e=t.node,n=t.data,r={},i=ld$.find(e,"[rbid='"+n.id+"'] [block] [block]"),ld$.find(e,"[block]").filter(function(t){return!in$(t,i)}).map(function(t){var e;return e=t.getAttribute("block"),(r.subblock||(r.subblock={}))["int:"+e]=t,t.parentNode.removeChild(t)}),r},construct:function(t){var e,n,r,i=this;return e=t.node,n=t.data,r=t.block,t.recurse,new Promise(function(t,o){var d,a,c,l;return d=ld$.find(e,"[editable]"),a=ld$.find(e,"[rbid='"+n.id+"'] [editable] [editable]"),d=d.filter(function(t){return!in$(t,a)}),c=n.data,l=d.map(function(t){var e,n,o;return e=t.getAttribute("editable"),t.getAttribute("edit-type")||(t.innerHTML=""),Array.isArray(n=c[e]||{})||(n=[n]),o=n.map(function(e){return"text"===e.type?(Promise.resolve(t.appendChild(document.createTextNode(e.value))),i.bind({node:t,data:e})):"block"===e.type?i.inject({host:t,data:e,recurse:!0,block:r}):void 0}),Promise.all(o)}),Promise.all(l).then(function(){return t()}).then(function(){return o()})})}};