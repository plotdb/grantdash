function import$(t,e){var n={}.hasOwnProperty;for(var a in e)n.call(e,a)&&(t[a]=e[a]);return t}var slice$=[].slice;ldc.register("adminEntry",["sdbAdapter"],function(t){var e,n;return e=t.sdbAdapter,n=function(t){var e,n,a,i=this;return this.opt=t,this.evtHandler={},this.root=e="string"==typeof t.root?document.querySelector(t.root):t.root,this.obj=n={active:null,data:{entries:[]}},this.view=a=new ldView({root:e,action:{input:{"entry-data":function(t){var e,r;return e=t.node,t.evt,r=e.getAttribute("data-name"),n.active&&(n.active[r]=e.value),a.render(),i.update()}},click:{"delete-entry":function(t){var e;if(t.node,t.evt,~(e=n.data.entries.indexOf(n.active)))return n.data.entries.splice(e,1),n.active=n.data.entries[e]||n.data.entries[e-1],a.render(),i.update()},"new-entry":function(e){var r,o;return e.node,e.evt,n.data.lastkey=r=(n.data.lastkey||0)+1,o=t.sample?"function"==typeof t.sample?t.sample({key:r}):JSON.parse(JSON.stringify(t.sample)):{name:"新項目",description:"未準備詳細描述的項目"},o.key=r,n.data.entries.push(o),n.active=o,a.render(),i.update()},switch:function(t){var e,a,r;return(e=t.node).classList.toggle("on"),a=e.getAttribute("data-name"),n.active&&(((r=n.active).config||(r.config={}))[a]=e.classList.contains("on")),i.update()}}},handler:{switch:function(t){var e,a,i;return e=t.node,a=e.getAttribute("data-name"),e.classList.toggle("on",!!n.active&&!!((i=n.active).config||(i.config={}))[a])},"entry-data":function(t){var e,a;return e=t.node,a=e.getAttribute("data-name"),e.value=(n.active||{})[a]||""},empty:function(t){return t.node.classList.toggle("d-none",n.data.entries.length)},entry:{list:function(){return n.data.entries},action:{click:function(t){var e;return t.node,e=t.data,t.evt,n.active=e,i.fire("toggle",n.active),a.render()}},handler:function(t){var e,a,i;if(e=t.node,a=t.data,(i=ld$.find(e,".nav-link",0)).classList.toggle("active",a===n.active),0===ld$.find(i,"[ld=entry-text]").map(function(t){return t.innerText=a[t.getAttribute("data-name")]||""}).length)return i.innerText=a.name}}}}),this},n.prototype=import$(import$(Object.create(Object.prototype),e.interface),{on:function(t,e){var n;return((n=this.evtHandler)[t]||(n[t]=[])).push(e)},fire:function(t){var e,n,a,i,r,o=[];for(e=slice$.call(arguments,1),n=0,i=(a=this.evtHandler[t]||[]).length;n<i;++n)r=a[n],o.push(r.apply(this,e));return o},update:function(){var t=this;return this.opsOut(function(){return t.obj.data})},opsIn:function(t){var e,n,a;if(e=t.data,t.ops,!t.source)return this.obj.data&&(n=this.obj.data.entries.indexOf(this.obj.active)),this.obj.data=JSON.parse(JSON.stringify(e||{})),this.obj.active=((a=this.obj.data).entries||(a.entries=[]))[~n?n:0]||{},this.fire("toggle",this.obj.active),this.view.render()}}),n});