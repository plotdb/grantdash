function import$(e,t){var n={}.hasOwnProperty;for(var r in t)n.call(t,r)&&(e[r]=t[r]);return e}ldc.register("judgeFinalAll",["notify","judgeBase","error","loader","auth","ldcvmgr","sdbAdapter"],function(e){var t,n,r,i,o,s;return e.notify,t=e.judgeBase,n=e.error,e.loader,e.auth,r=e.ldcvmgr,e.sdbAdapter,{0:"accept",1:"pending",2:"reject"},i=[["i-check","text-success"],["i-circle","text-secondary"],["i-close","text-danger"]],function(e,t){var n,r;return n=i[t],(r=Array.from(e.classList)).length&&e.classList.remove.apply(e.classList,r),e.classList.add.apply(e.classList,n)},o=function(e){return import$(this,new t(e)),this.data={prj:{}},this.active=null,this.view.local=new ldView({initRender:!1,root:this.root}),this},o.prototype=import$(import$({},t.prototype),{opsIn:function(e){var t,n,r,i=this;if(t=e.data,e.ops,!e.source)return this.data=JSON.parse(JSON.stringify(t)),(n=this.data).prj||(n.prj={}),r=this.prjs.map(function(e,t){var n;return n=[t],i.judges.map(function(t){var r,o,s,u;return r=(o=i.data.user)[s=t.key]||(o[s]={}),u=i.grade.map(function(t,n){var i,o,s;return((i=(o=r.prj||(r.prj={}))[s=e.key]||(o[s]={})).v||(i.v={}))[t.key]||0}).reduce(function(e,t){return e+ +t},0),n.push(u),n.push(0)}),n}),this.judges.map(function(e,t){var n,i,o,s,u=[];for(n=2*t+1,r.sort(function(e,t){return t[n]-e[n]}),i={idx:0,value:null},o=0,s=r.length;o<s;++o)t=o,i.value!==r[t][n]&&(i.idx=t,i.value=r[t][n]),u.push(r[t][n+1]=i.idx+1);return u}),r.sort(function(e,t){return e[0]-t[0]}),(r=r.map(function(e){return e.splice(1)})).length||(r=[[]]),this.sheet.populateFromArray(2,3,r),this.render()},render:function(){return this.getProgress(),this.view.base.render(),this.view.local.render()},reconnect:function(){var e=this;return this.getdoc().then(function(){return e.sort("name",null,!1)}).then(function(){return console.log("initied.")})},initSheet:function(){var e,t=this;return console.log("init sheet ... "),this.sheet=s({root:edit,afterChange:function(e){null==e&&(e=[])}}),this.judges=[{name:"評審A",key:1},{name:"評審B",key:2},{name:"評審C",key:3}],this.prjs.sort(function(e,t){return e.key-t.key}),e=[["","","評審"].concat(this.judges.map(function(e){return[e.name,""]}).reduce(function(e,t){return e.concat(t)},[]),["平均","優勝"]),["編號","評論","提案"].concat(this.judges.map(function(){return["分數","排名"]}).reduce(function(e,t){return e.concat(t)},[]),["排名","註記"])].concat(this.prjs.map(function(e,n){return[e.key,"",e.name].concat(t.grade.map(function(){return 0}),[0,1,""])})),this.sheet.loadData(e),this.sheet.render(),this.render()},init:function(){var e=this;return Promise.resolve().then(function(){return e.auth()}).then(function(){return e.initView()}).then(function(){return e.fetchInfo()}).then(function(){return e.grpinfo.grade?e.grade=e.grpinfo.grade.entries:r.get("judge-grade-missing")}).then(function(){return e.fetchPrjs()}).then(function(){return e.initSheet()}).then(function(){return e.sharedb()}).then(function(){return e.getdoc()}).then(function(){return console.log("initied.")}).catch(n())},getProgress:function(){}}),new o({root:document.body}).init(),s=function(e){return Handsontable.renderers.registerRenderer("myrenderer",function(e,t,n,r,i,o,s){return Handsontable.renderers.TextRenderer.apply(this,arguments)}),new Handsontable(e.root,import$({rowHeaders:!0,colHeaders:!0,filters:!0,dropdownMenu:!0,rowHeights:25,colWidths:[40,50,220],minRows:50,minCols:15,stretchH:"all",fixedRowsTop:2,fixedColumnsLeft:3,cells:function(e,t){return{renderer:"myrenderer"}}},e))}});