// Generated by LiveScript 1.3.0
ldc.register(['auth'], function(arg$){
  var auth;
  auth = arg$.auth;
  return auth.get().then(function(global){
    var lc, view;
    lc = {};
    view = new ldView({
      global: true,
      root: document.body,
      action: {
        click: {
          "grantdash-logout": function(arg$){
            var node;
            node = arg$.node;
            return ld$.fetch('/dash/api/u/logout', {
              method: 'POST'
            }, {})['finally'](function(){
              return window.location.reload();
            });
          },
          "grantdash-propose": function(arg$){
            var node;
            node = arg$.node;
          }
        }
      },
      handler: {
        "grantdash-logout": function(arg$){
          var node;
          node = arg$.node;
          return node.style.display = !global.user.key ? "none" : "";
        },
        "grantdash-propose": function(arg$){
          var node;
          node = arg$.node;
        },
        "grantdash-login": function(arg$){
          var node;
          node = arg$.node;
          node.style.display = global.user.key ? "none" : "";
          return node.setAttribute('href', "/dash/auth/?nexturl=" + window.location.pathname);
        },
        "grantdash-project-list-link": function(arg$){
          var node;
          node = arg$.node;
          return console.log(node.getAttribute('pd'));
        },
        "grantdash-project-list": function(arg$){
          var node;
          node = arg$.node;
          return console.log(node.getAttribute('pd'));
        },
        "grantdash-project-list-item": {
          list: function(){
            return lc.data;
          },
          init: function(arg$){
            var node, data, local;
            node = arg$.node, data = arg$.data, local = arg$.local;
            return local.view = new ldView({
              context: data,
              root: node,
              handler: {
                title: function(arg$){
                  var node, context;
                  node = arg$.node, context = arg$.context;
                  return node.innerText = context.name;
                },
                description: function(arg$){
                  var node, context;
                  node = arg$.node, context = arg$.context;
                  return node.innerText = context.description;
                },
                thumb: function(arg$){
                  var node, context;
                  node = arg$.node, context = arg$.context;
                  if (context.thumb) {
                    return node.style.backgroundImage = "url(" + context.thumb + ")";
                  }
                }
              }
            });
          },
          handler: function(arg$){
            var node, local, data;
            node = arg$.node, local = arg$.local, data = arg$.data;
            node.setAttribute('href', "/dash/prj/" + data.slug);
            local.view.setContext(data);
            return local.view.render();
          }
        }
      }
    });
    return ld$.fetch("/dash/api/brd/g0v-unith1n/prj/list", {
      method: 'GET'
    }, {
      type: 'json'
    }).then(function(it){
      lc.data = it;
      return view.render();
    })['catch'](function(){});
  });
});