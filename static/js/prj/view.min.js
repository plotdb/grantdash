ldc.register("prjView",["auth","error","stage","viewLocals","discussView"],function(e){var t,n,i,r,o,a,s,l,u;return t=e.auth,n=e.error,i=e.stage,r=e.discussView,e.discussEdit,o=e.viewLocals,a={},s=o.prj,l=o.brd,u=o.grp,t.get().then(function(e){return a.global=e,i.get({brd:l.slug})}).then(function(e){var t,n,i,c;return null==e&&(e={}),a.stage=e.config||{},t=(n=s.detail||(s.detail={})).answer||(n.answer={}),i=(n=u.form||(u.form={})).list||(n.list=[]),c={},i.map(function(e){return c[e.key]=e}),r&&new r({root:"[ld-scope=discuss]"}).init(),new ldView({global:!0,root:document.body,handler:{"stage-ctrl":function(e){var t,n;return t=e.node,n=t.getAttribute("data-name"),t.classList.toggle("d-none",!a.stage[n])}}}),new ldView({root:document.body,init:{"btn-share":function(e){var t,n;return t=e.node,n=e.local,n.clipboard=new ClipboardJS(t,{text:function(e){return window.location.href}}),n.clipboard.on("success",function(){return clearTimeout(n.h),t.classList.add("tip-on"),n.h=setTimeout(function(){return t.classList.remove("tip-on")},1e3)})}},handler:{"btn-edit":function(e){return e.node.classList.toggle("d-none",a.global.user.key!==o.owner)},answer:function(e){var n,i,r,o,a,u,d;if(n=e.node,i=n.getAttribute("data-key"),r=c[i],(o=t[i]||{})&&(r=c[i]))return o.content?o.useMarkdown?n.innerHTML=DOMPurify.sanitize(marked(o.content)):n.innerText=o.content:o.list?"form-file"===(a=r.name)||"form-thumbnail"===a?(u=(o.list||[]).map(function(e){return'<li><a href="/dash/org/'+l.org+"/prj/"+s.slug+"/upload/"+e.path+'">\n'+htmlentities(e.name)+"\n</a></li>"}).join(""),n.innerHTML=DOMPurify.sanitize(u)):"form-checkpoint"===r.name?(u=(o.list||[]).map(function(e){return"<p><div><b><big>"+htmlentities(e.title)+"</big></b></div>\n<div>"+htmlentities(e.desc)+"</div></p>"}).join(""),n.innerHTML="<blockquote style='margin-left:1em'>"+DOMPurify.sanitize(u)+"</blockquote>"):(d=o.list.concat(o.otherValue&&o.other?[o.otherValue]:[]),n.innerHTML=DOMPurify.sanitize(d.join("<br>"))):void 0}}})}).catch(n())}),ldc.app("prjView");