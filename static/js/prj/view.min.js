ldc.register("prjView",["auth","error","stage","viewLocals","discussView"],function(t){var e,n,i,r,o,a,s,l,u;return e=t.auth,n=t.error,i=t.stage,r=t.discussView,t.discussEdit,o=t.viewLocals,a={},s=o.prj,l=o.brd,u=o.grp,e.get().then(function(t){return a.global=t,i.get({brd:l.slug})}).then(function(t){var e,n,i,c;return null==t&&(t={}),a.stage=t.config||{},e=(n=s.detail||(s.detail={})).answer||(n.answer={}),i=(n=u.form||(u.form={})).list||(n.list=[]),c={},i.map(function(t){return c[t.key]=t}),r&&new r({root:"[ld-scope=discuss]"}).init(),new ldView({global:!0,root:document.body,handler:{"stage-ctrl":function(t){var e,n;return e=t.node,n=e.getAttribute("data-name"),e.classList.toggle("d-none",!a.stage[n])}}}),new ldView({root:document.body,init:{"btn-share":function(t){var e,n;return e=t.node,n=t.local,n.clipboard=new ClipboardJS(e,{text:function(t){return window.location.href}}),n.clipboard.on("success",function(){return clearTimeout(n.h),e.classList.add("tip-on"),n.h=setTimeout(function(){return e.classList.remove("tip-on")},1e3)})}},handler:{"btn-edit":function(t){return t.node.classList.toggle("d-none",a.global.user.key!==o.owner)},answer:function(t){var n,i,r,o,a,u,d,m,f;if(n=t.node,i=n.getAttribute("data-key"),r=c[i],(o=e[i]||{})&&(r=c[i]))return o.content?o.useMarkdown?n.innerHTML=DOMPurify.sanitize(marked(o.content)):n.innerText=o.content:o.start?(a=moment(o.start).format("YYYY-MM-DD hh:mm:ss"),u=moment(o.end).format("YYYY-MM-DD hh:mm:ss"),n.innerText=(r.config||(r.config={})).rangeEnabled?a+" - "+u:a):o.list?"form-file"===(d=r.name)||"form-thumbnail"===d?(m=(o.list||[]).map(function(t){return'<li><a href="/dash/org/'+l.org+"/prj/"+s.slug+"/upload/"+t.path+'">\n'+htmlentities(t.name)+"\n</a></li>"}).join(""),n.innerHTML=DOMPurify.sanitize(m)):"form-checkpoint"===r.name?(m=(o.list||[]).map(function(t){return"<p><div><b><big>"+htmlentities(t.title)+"</big></b></div>\n<div>"+htmlentities(t.desc)+"</div></p>"}).join(""),n.innerHTML="<blockquote style='margin-left:1em'>"+DOMPurify.sanitize(m)+"</blockquote>"):(f=o.list.concat(o.otherValue&&o.other?[o.otherValue]:[]),n.innerHTML=DOMPurify.sanitize(f.join("<br>"))):void 0}}})}).catch(n())}),ldc.app("prjView");