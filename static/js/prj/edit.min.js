function import$(r,t){var n={}.hasOwnProperty;for(var e in t)n.call(t,e)&&(r[e]=t[e]);return r}ldc.register(["prjForm","loader","ldcvmgr","error"],function(r){var t,n,e,o,i,c,u;return t=r.prjForm,n=r.loader,r.ldcvmgr,e=r.error,o=function(r){return this.ldcv=new ldCover({root:"[ld-scope=prj-diff]"}),this.view=new ldView({global:!0,initRender:!1,root:"[ld-scope=prj-form-use]",handler:{"init-loader":function(r){return r.node.classList.toggle("d-none",!0)}}}),this.slug=r.prj,this.prj={},this},o.prototype=import$(Object.create(Object.prototype),{fetch:function(){var r=this;return console.log("fetching project information ..."),console.log("fetching board form ..."),ld$.fetch("/d/p/"+this.slug,{method:"GET"},{type:"json"}).then(function(t){return r.prj=t,ld$.fetch("/d/b/"+r.prj.brdslug+"/form",{method:"GET"},{type:"json"})}).then(function(t){return r.brd=t,r.grp=r.brd.detail.group[0]||{}})},sharedb:function(){var r;return console.log("initializing sharedb connection ..."),this.sdb=r=new sharedbWrapper({url:{scheme:window.location.protocol.replace(":",""),domain:window.location.host}}),r.on("close",function(){return n.on(),r.reconnect().then(function(){}).then(function(){return n.off()})}),this.hubs={prj:new Hub({sdb:r})}},getdoc:function(){var r=this;return console.log("get project document ..."),this.sdb.get({id:"prj-"+this.slug,watch:function(t,n){return r.hubs.prj.fire("change",{ops:t,source:n})},create:function(){var t,n,e,o;return t={},n=(e=r.grp).form||(e.form={}),(t[o=(n.purpose||(n.purpose={})).title||"title"]||(t[o]={})).content=r.prj.name,(t[o=n.purpose.description||"description"]||(t[o]={})).content=r.prj.description,t}}).then(function(t){return r.hubs.prj.doc=t})},initForm:function(){var r;return this.ctrlForm=new t({root:"[ld-scope=prj-form-use]",viewMode:!0,form:(r=this.grp).form||(r.form={}),grp:this.grp,brd:this.brd}),this.ctrlForm.adapt({hub:this.hubs.prj,path:["content"]}),this.ctrlForm.on("submit",function(r){return console.log(r)})},render:function(){return this.view.render()}}),i=/^\/p\/([^/]+)\/edit/.exec(window.location.pathname)||[],i[0],c=i[1],(u=new o({prj:c})).fetch().then(function(){return u.sharedb()}).then(function(){return u.getdoc()}).then(function(){return u.initForm()}).then(function(){return u.render()}).then(function(){return n.off()}).catch(e())});