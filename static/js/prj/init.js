// Generated by LiveScript 1.3.0
ldc.register(['ldcvmgr', 'adminInfo', 'prjCreate', 'auth', 'error', 'loader'], function(arg$){
  var ldcvmgr, adminInfo, prjCreate, auth, error, loader, lc, key;
  ldcvmgr = arg$.ldcvmgr, adminInfo = arg$.adminInfo, prjCreate = arg$.prjCreate, auth = arg$.auth, error = arg$.error, loader = arg$.loader;
  loader.on();
  lc = {};
  key = {
    brd: 4,
    grp: 'grp-ppg7kz3njm'
  };
  return auth.get().then(function(){
    return ld$.fetch("/d/b/" + key.brd + "/form", {
      method: 'GET'
    }, {
      type: 'json'
    });
  }).then(function(brd){
    var ref$, res$, k, v, root, n, showGrp, info, view;
    lc.brd = brd;
    lc.grps = (ref$ = brd.detail).group || (ref$.group = {});
    res$ = [];
    for (k in ref$ = brd.detail.group) {
      v = ref$[k];
      res$.push(v);
    }
    lc.grpList = res$;
    lc.grp = lc.grps[key.grp];
    if (!lc.grp) {
      return Promise.reject(new Error(1015));
    }
    root = ld$.find('[ld-scope=prj-create]', 0);
    n = ld$.find(root, 'input[name=brd]', 0);
    n.value = key.brd;
    showGrp = (function(){
      var results$ = [];
      for (k in lc.grps) {
        results$.push(k);
      }
      return results$;
    }()).length === 1 ? false : true;
    info = new adminInfo({
      root: root,
      type: 'prj'
    });
    view = new ldView({
      root: root,
      action: {
        input: {
          grp: function(arg$){
            var node;
            node = arg$.node;
            key.grp = node.value;
            lc.grp = lc.grps[key.grp];
            return view.render();
          }
        }
      },
      handler: {
        "grp-option": {
          list: function(){
            return lc.grpList;
          },
          handler: function(arg$){
            var node, data;
            node = arg$.node, data = arg$.data;
            node.value = data.key;
            return node.innerText = data.info.name;
          }
        },
        "brd-name": function(arg$){
          var node;
          node = arg$.node;
          return node.innerText = lc.brd.name;
        },
        "grp-name": function(arg$){
          var node;
          node = arg$.node;
          return node.innerText = lc.grp.info.name;
        },
        "show-grp": function(arg$){
          var node;
          node = arg$.node;
          return node.classList.toggle('d-none', !showGrp);
        },
        "inited": function(arg$){
          var node;
          node = arg$.node;
          return node.classList.toggle('invisible', false);
        }
      }
    });
    n = ld$.find(root, 'select[name=grp]', 0);
    return n.value = key.grp;
  })['finally'](function(){
    return loader.off();
  })['catch'](error());
});