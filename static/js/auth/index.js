// Generated by LiveScript 1.3.0
ldc.register(['general', 'auth', 'loader', 'navtop'], function(arg$){
  var general, auth, loader, navtop, nexturl, reload;
  general = arg$.general, auth = arg$.auth, loader = arg$.loader, navtop = arg$.navtop;
  nexturl = (window.location.search || '').replace(/^\?/, '').split('&').map(function(it){
    return decodeURIComponent(it).trim().split('=');
  }).filter(function(it){
    return it[0] === 'nexturl';
  }).map(function(it){
    return it[1];
  })[0] || '/';
  reload = function(){
    loader.on();
    return window.location.href = nexturl;
  };
  auth.init({
    root: '.authpanel'
  });
  auth.fetch({
    renew: true
  }).then(function(it){
    if (it.user.key) {
      return reload();
    }
  });
  return auth.on('auth.signin', function(){
    return reload();
  });
});