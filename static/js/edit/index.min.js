!function(){var e,n;(e=new sharedbWrapper({url:{scheme:window.location.protocol.replace(":",""),domain:window.location.host},path:"/dash/ws"})).on("close",function(){return loader.on(),e.reconnect().then(function(){return init()}).then(function(){return loader.off()})}),{pages:new Hub({sdb:e}),file:new Hub({sdb:e})},n=function(e){var r,t,i,d,o;if(!e.children)return[e];for(r=0,i=(t=e.children).length;r<i;++r)if(d=t[r],o=n(d))return[e].concat(o)},e.get({id:"brd/4/pages",watch:function(e,n){return hub.pages.fire("change",{ops:e,source:n})}}).then(function(r){var t;if(hub.pages.doc=r,t=n(r.data.tree))return e.get({id:"brd/4/pages["+t.join("/")+"]",watch:function(e,n){return hub.file.fire("change",{ops:e,source:n})}})}).then(function(e){return hub.file.doc=e}),ldc.register("editor",[],function(){var e,n,r,t;return{pages:[],styles:[],js:[],widgets:[],assets:[]},e={children:[{name:"page",children:[{name:"index.html"}]},{name:"style",children:[{name:"index.css"}]},{name:"script",children:[{name:"index.js"}]},{name:"widget",children:[]},{name:"asset",children:[{name:"thumb.png"}]}]},n=function(r){var i,d,o,a;return i=r.node,d=r.data,r.parent,o=i,a=d,new ldView({root:i,action:{input:{name:function(e){var n;return n=e.node,e.evt,d.name=n.value},url:function(e){var n;return n=e.node,e.evt,d.url=n.value}},click:{clone:function(n){var r;return n.node,n.evt,r=o.pdata.children.indexOf(d),o.pdata.children.splice(r+1,0,JSON.parse(JSON.stringify(d))),rootView.render(),console.log(JSON.stringify(e))},delete:function(e){var n;return e.node,e.evt,n=o.pdata.children.indexOf(d),o.pdata.children.splice(n,1),rootView.render()},"toggle-fold":function(e){var n,r,t;return e.node,e.evt,d.children?(n=o.pdata.children.indexOf(d),r=d.children,delete d.children,delete d.toggle,r=[JSON.parse(JSON.stringify(d))].concat(r),o.pdata.children.splice.apply(o.pdata.children,[n,1].concat(r)),rootView.render()):(n=o.pdata.children.indexOf(d),t=JSON.parse(JSON.stringify(d)),t.toggle=!0,t.children=[],o.pdata.children.splice.apply(o.pdata.children,[n,1].concat([t])),rootView.render())}}},handler:{name:function(e){var n;return n=e.node,n.innerText=d.name},url:function(e){var n;return n=e.node,n.value=d.url||""},icon:function(e){return e.node.classList.toggle("d-none",!!d.children)},list:{list:function(){return d.children},init:function(e){var r,i,d;return r=e.node,i=e.data,d=t.get(i.children?"folder":"item").childNodes[0],r.setAttribute("class",d.getAttribute("class")),r.setAttribute("draggable",!0),r.innerHTML=d.innerHTML,i.children&&(r.folder=new ldui.Folder({root:r})),r.pdata=a,r.view=n({node:r,data:i})},handler:function(e){var n;if(n=e.node,e.data,n.view)return n.view.render()}}}})},r={menu:ld$.find("[ld-scope=editor-menu]",0),sample:ld$.find("[ld-scope=editor-menu-sample]",0)},console.log(r),t=new ldView({root:r.sample,handler:{item:function(){},folder:function(){}}}),n({node:r.menu,data:e}),ldc.action({get:function(){return console.log(editor.getContents())}})}),ldc.app("editor")}();