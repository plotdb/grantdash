function in$(n,e){for(var t=-1,o=e.length>>>0;++t<o;)if(n===e[t])return!0;return!1}ldc.register("discus",["auth"],function(n){var e,t,o;return e=n.auth,t={},o={loading:!0,data:{slug:"/",content:{config:{}}}},e.get().then(function(n){var e;return ld$.fetch("/dash/api/discus",{method:"GET"},{params:{slug:"/"},type:"json"}).then(function(n){return o.comments=n,o.loading=!1,e.render()}),o.g=n,e=new ldView({root:"[ld-scope=discus]",action:{input:{"use-markdown":function(n){var t,r,a;return t=n.node,((r=(a=o.data).content||(a.content={})).config||(r.config={})).useMarkdown=o.useMarkdown=t.checked,e.render()},"toggle-preview":function(n){var t;return t=n.node,o.preview=!!t.checked,e.render()},input:function(n){var t,r;return t=n.node,((r=o.data).content||(r.content={})).body=t.value,o.ready=!!(((r=o.data).content||(r.content={})).body||"").trim().length,e.render("post")}},click:{link:function(){},attach:function(){},post:function(n){var e,t;if(!n.node.classList.contains("running"))return e={slug:(t=o.data).slug,reply:t.reply,content:t.content},o.ldld.on(),ld$.fetch("/dash/api/comment",{method:"POST"},{type:"json",json:e}).finally(function(){return o.ldld.off()}).then(function(){return console.log("posted")}).catch(function(){return console.log("failed")})}}},init:{post:function(n){var e;return e=n.node,o.ldld=new ldLoader({root:e})}},handler:{loading:function(n){var e,t;return(e=n.node).classList.toggle("d-none",!(!o.loading!=!(t=in$("off",e.getAttribute("ld").split(" ")))&&(o.loading||t)))},avatar:function(e){var t;return t=e.node,t.style.backgroundImage="url(/s/avatar/"+n.user.key+".png)"},preview:function(n){var e,t,r,a;return e=n.node,t=in$("off",e.getAttribute("ld").split(" ")),r=!(a=!(o.preview&&o.useMarkdown))!=!t&&(a||t),e.classList.toggle("d-none",r)},panel:function(n){var e;if(e=n.node,o.preview)return e.innerHTML=marked(o.data.content.body||"",t)},post:function(n){return n.node.classList.toggle("disabled",!o.ready)},"edit-panel":function(n){return n.node.classList.toggle("d-none",!!o.preview)},"if-markdown":function(n){return n.node.classList.toggle("d-none",!o.useMarkdown)},comment:{list:function(){return o.comments},init:function(n){var e,t,o;return e=n.node,t=n.data,o=n.idx,e.classList.add("ld","ld-float-ltr-in","xp35"),e.style.animationDelay=.1*o+"s",new ldView({root:e,handler:{avatar:function(n){var e;return e=n.node,e.style.backgroundImage="url(/s/avatar/"+t.owner+".png)"},author:function(n){var e;return e=n.node,e.innerText=t.displayname},role:function(n){var e;return(e=n.node).classList.toggle("d-none",!t.role),ld$.find(e,"span",0).innerText=t.role},date:function(n){var e;return e=n.node,e.innerText=moment(t.createdtime).tz("Asia/Taipei").format("YYYY/MM/DD hh:mm:ss")},content:function(n){var e,o;return e=n.node,((o=t.content).config||(o.config={})).useMarkdown?e.innerHTML=marked(t.content.body):e.innerText=t.content.body}}})}}}})})}),ldc.app("discus");