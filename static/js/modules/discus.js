// Generated by LiveScript 1.3.0
(function(){
  ldc.register('discus', ['auth'], function(arg$){
    var auth, renderer, markedOptions;
    auth = arg$.auth;
    renderer = new marked.Renderer();
    renderer.heading = function(text, level){
      return text;
    };
    markedOptions = {
      renderer: renderer
    };
    return auth.get().then(function(g){
      var fetch, post, lc, view;
      fetch = function(){};
      post = function(){};
      lc = {};
      return view = new ldView({
        root: '[ld-scope=discus-edit]',
        action: {
          input: {
            "use-markdown": function(arg$){
              var node;
              node = arg$.node;
              lc.useMarkdown = node.checked;
              return view.render();
            },
            "toggle-preview": function(arg$){
              var node;
              node = arg$.node;
              lc.preview = !!node.checked;
              return view.render();
            },
            comment: function(arg$){
              var node;
              node = arg$.node;
              return lc.content = node.value;
            }
          },
          click: {
            link: function(){},
            attach: function(){},
            post: function(){}
          }
        },
        handler: {
          avatar: function(arg$){
            var node;
            node = arg$.node;
            return node.style.backgroundImage = "url(/s/avatar/" + g.user.key + ".png)";
          },
          preview: function(arg$){
            var node, revert;
            node = arg$.node;
            revert = in$("off", node.getAttribute('ld').split(" "));
            return node.classList.toggle('d-none', revert
              ? !!lc.preview
              : !lc.preview);
          },
          panel: function(arg$){
            var node;
            node = arg$.node;
            if (lc.preview) {
              return node.innerHTML = marked(lc.content || '', markedOptions);
            }
          },
          "edit-panel": function(arg$){
            var node;
            node = arg$.node;
            return node.classList.toggle('d-none', !!lc.preview);
          },
          "if-markdown": function(arg$){
            var node;
            node = arg$.node;
            return node.classList.toggle('d-none', !lc.useMarkdown);
          }
        }
      });
    });
  });
  return ldc.app('discus');
})();
function in$(x, xs){
  var i = -1, l = xs.length >>> 0;
  while (++i < l) if (x === xs[i]) return true;
  return false;
}