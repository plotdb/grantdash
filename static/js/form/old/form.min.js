!function(){var e,n,t,r,i,a,o;e={types:{number:{name:"數值",ops:"number"},string:{name:"文字",ops:"string"},length:{name:"長度",ops:"count"},regex:{name:"正規式",ops:"regex"},count:{name:"選項數",ops:"count"},"file-size":{name:"檔案大小",ops:"smaller"},"file-format":{name:"檔案格式",ops:"extension"},"file-count":{name:"檔案數量",ops:"count"}},ops:{extension:{extension:{name:"副檔名"}},regex:{match:{name:"符合"},"not-match":{name:"不符"}},count:{gte:{name:'<div class="s mr-2">&#x2265;</div> 大於或等於'},lte:{name:'<div class="s mr-2">&#x2264;</div> 小於或等於'},eq:{name:'<div class="s mr-2">=</div> 等於'},between:{name:'<div class="s mr-2">&#x223c;</div> 介於',field:2}},string:{include:{name:"包含"},exclude:{name:"不包含"},email:{name:"電子郵件位置"},url:{name:"網址"}},number:{gte:{name:'<div class="s mr-2">&#x2265;</div> 大於或等於'},lte:{name:'<div class="s mr-2">&#x2264;</div> 小於或等於'},ge:{name:'<div class="s mr-2">&gt;</div> 大於'},le:{name:'<div class="s mr-2">&lt;</div> 小於'},eq:{name:'<div class="s mr-2">=</div> 等於'},ne:{name:'<div class="s mr-2">&#x2260;</div> 不等於'},between:{name:'<div class="s mr-2">&#x223c;</div> 介於',field:2}},smaller:{ge:{name:'<div class="s mr-2">&gt;</div> 大於'}}},support:{"form-short-answer":["number","string","length","regex"],"form-long-answer":["string","length","regex"],"form-radio":[],"form-checkbox":["count"],"form-file":["file-size","file-formt","file-count"],"form-budget":["count"],"form-checkpoint":["count"]}},n=function(n){var t,r,i,a;return t=n.node,r=n.data,i=r,(t.view||(t.view={})).criteria=a=new ldView({root:t,action:{click:{add:function(){return(r.criteria||(r.criteria=[])).push({type:"number"}),a.render()}}},handler:{criteria:{list:function(){return r.criteria||(r.criteria=[])},action:{click:function(e){var n,t,r,i;if(n=e.node,t=e.data,r=e.evt,i=ld$.parent(r.target,".dropdown-item",n))return i.type&&(t.type=i.type),i.op&&(t.op=i.op),n.view.render()}},init:function(n){var t,r,a,o;return t=n.node,r=n.data,a=function(){return r.type||e.support[i.name][0]||"number"},o=function(){var n,t,i;return n=e.ops[e.types[a()].ops],t=function(){var e,r=[];for(i in e=n)t=e[i],r.push(t);return r}()[0],n[r.op]||t||{name:""}},ld$.find(t,".dropdown .dropdown-toggle").map(function(e){return new Dropdown(e)}),t.view=new ldView({root:t,action:{input:{input1:function(e){var n;return n=e.node,r.input1=ld$.find(n,"input",0).value},input2:function(e){var n;return n=e.node,r.input2=ld$.find(n,"input",0).value},invalid:function(e){var n;return n=e.node,r.invalid=n.value}}},handler:{input1:function(e){var n;return n=e.node,ld$.find(n,"input",0).value=r.input1||""},input2:function(e){var n;return(n=e.node).classList.toggle("d-none",(o().field||1)<2),ld$.find(n,"input",0).value=r.input2||""},invalid:function(e){var n;return n=e.node,n.value=r.invalid||""},type:function(n){var t;return t=n.node,t.innerText=e.types[a()].name},op:function(e){var n;return n=e.node,n.innerHTML=o().name},types:{list:function(){return e.support[i.name]},handler:function(n){var t,r;return t=n.node,r=n.data,t.innerText=e.types[r].name,t.type=r}},ops:{list:function(){var n,t,r,i=[];for(n in t=e.ops[e.types[a()].ops])r=t[n],i.push([n,r]);return i},handler:function(e){var n,t;return n=e.node,t=e.data,n.innerHTML=t[1].name,n.op=t[0]}}}})},handler:function(e){var n;if(n=e.node,e.data,n.view)return n.view.render()}}}})},t=function(e){var n,t,r,i;return n=e.node,t=e.data,r=t.data||(t.data=[]),(n.view||(n.view={})).list=i=new ldView({root:n,action:{click:{"list-add":function(){return r.push({title:"某個點",desc:"某個點的描述"}),i.render()}}},handler:{list:{list:function(){return r},init:function(e){var n,t;return n=e.node,t=e.data,!0,n.view=new ldView({root:n,action:{input:{"list-data":function(e){var n;return n=e.node,t[n.getAttribute("data-name")]=n.innerText}}},init:{"list-data":function(e){var n;(n=e.node).setAttribute("data-name",n.getAttribute("editable"))}},handler:{"list-data":function(e){var n;return n=e.node,n.innerText=t[n.getAttribute("data-name")]||""}}})},render:function(e){return e.node.render()}}}})},r={"form-radio":t,"form-checkbox":t,"form-checkpoint":t},i=function(e){var n,t;return n=e.node,t=e.data,(n.view||(n.view={})).block=new ldView({root:n,action:{input:{title:function(e){var n;return n=e.node,e.evt,t.title=n.innerText},desc:function(e){var n;return n=e.node,e.evt,t.desc=n.innerText}},click:{switch:function(e){var n;return n=e.node,e.evt,n.classList.toggle("on"),(t.config||(t.config={}))[n.getAttribute("data-name")]=n.classList.contains("on")},delete:function(e){e.node,e.evt},clone:function(e){return e.node,e.evt,console.log(t)}}},handler:{title:function(e){var n;return n=e.node,n.innerText=t.title},desc:function(e){var n;return n=e.node,n.innerText=t.desc},switch:function(e){var n;return(n=e.node).classList.toggle("on",!!(t.config||(t.config={}))[n.getAttribute("data-name")])}}})},a=[{name:"form-short-answer",title:"提問的標題1",desc:"提問的描述",config:{required:!0},criteria:[{}]},{name:"form-long-answer",title:"提問的標題2",desc:"提問的描述",config:{required:!0},criteria:[{}]},{name:"form-checkpoint",title:"提問的標題3",desc:"提問的描述",data:[{title:"第一個點",desc:"第一個點的描述"}],config:{required:!0},criteria:[{}]},{name:"form-radio",title:"提問的標題3",desc:"提問的描述",data:[{title:"第一個點",desc:"第一個點的描述"}],config:{required:!0},criteria:[{}]},{name:"form-checkbox",title:"提問的標題3",desc:"提問的描述",data:[{title:"第一個點",desc:"第一個點的描述"}],config:{required:!0},criteria:[{}]}],o={get:function(e){return new Promise(function(n,t){var r,i;return(r=ld$.find("[data-name="+e+"]",0))||t(new Error("block not found")),(i=ld$.create({name:"div",attr:{draggable:!0}})).appendChild(r.cloneNode(!0)),n(i)})}},new ldView({root:"#form",handler:{block:{list:function(){return a},init:function(e){var t,a;return t=e.node,a=e.data,o.get(a.name).then(function(e){var o;if((e=e.childNodes[0]).parentNode.removeChild(e),t.innerHTML="",t.appendChild(e),i({node:t,data:a}),n({node:t,data:a}),o=r[a.name])return o({node:t,data:a})})}}}}),new ldView({root:"[ld-scope=blocksrc]",action:{dragstart:{block:function(e){var n;return n=e.node,e.evt.dataTransfer.setData("text/plain",n.getAttribute("data-name")+"")}}}}),new reblock({root:"#form",blockManager:o,action:{afterMoveNode:function(e){var n,t;if(n=e.src,e.des,e.ib,n.parentNode.hasAttribute("hostable")){for(t=n.parentNode;t&&!t._data;)t=t.parentNode;if(!t)return;return t._data.data=Array.from(n.parentNode.childNodes).filter(function(e){return 1===e.nodeType}).map(function(e){return e._data}).filter(function(e){return e}),t.view.list.render()}}}})}();