function in$(e,r){for(var n=-1,t=r.length>>>0;++n<t;)if(e===r[n])return!0;return!1}ldc.register("prjForm",["prjFormCriteria","prjFormBlock","prjFormValidation"],function(e){var r,n,t,a,o,d,i,l,c;r=e.prjFormCriteria,n=e.prjFormBlock,t=e.prjFormValidation,a={update:function(e){return i.render()},render:function(){}},o={get:function(e){return new Promise(function(r,n){var t,a;return(t=ld$.find("[data-name="+e+"]",0))||n(new Error("block not found")),(a=ld$.create({name:"div",attr:{draggable:!0}})).appendChild(t.cloneNode(!0)),r(a)})}},debounce(function(e){if(e.valid=t.validate(e),i.render(),c)return c.render()}),d=function(e){return a.update(e)},setInterval(function(){return console.log(sampleBlocks.length,JSON.stringify(sampleBlocks))},3e3),i=new ldView({root:"#form",handler:{block:{list:function(){return sampleBlocks},init:function(e){var t,a;return t=e.node,a=e.data,o.get(a.name).then(function(e){return(e=e.childNodes[0]).parentNode.removeChild(e),t.innerHTML="",t.appendChild(e),n.render({node:t,rootData:sampleBlocks,data:a,viewMode:!1,update:d}),r.render({node:t,data:a})})},handler:function(e){var r;if(r=e.node,e.data,r.view)return r.view.block.render()}}}}),(l=ld$.find("[ld-scope=blocksrc]",0))&&new ldView({root:l,action:{dragstart:{block:function(e){var r;return r=e.node,e.evt.dataTransfer.setData("text/plain",r.getAttribute("data-name")+"")}}}}),new reblock({root:"#form",blockManager:o,action:{afterInject:function(e){var r,n,t,a;return r=e.node,n=e.name,t={key:Math.random().toString(36).substring(2),name:n,title:"提問的標題1",desc:"提問的描述",config:{required:!0},criteria:[{type:"number",op:"between",input1:10,input2:20,invalid:"應介於 10 ~ 20 之間"}]},r._data=t,a=Array.from(r.parentNode).indexOf(r),sampleBlocks.splice(a,0,t),i.bindEachNode({name:"block",container:r.parentNode,node:r}),i.render()},afterMoveNode:function(e){var r,n,t,a;if(r=e.src,e.des,n=e.ib,r.parentNode.hasAttribute("hostable")){for(t=r.parentNode;t&&!t._data;)t=t.parentNode;return t?(t._data.data=Array.from(r.parentNode.childNodes).filter(function(e){return 1===e.nodeType}).map(function(e){return e._data}).filter(function(e){return e}),t.view.list.render()):(a=sampleBlocks.indexOf(r._data),sampleBlocks.splice(a,1),n=n?sampleBlocks.indexOf(n._data):sampleBlocks.length,sampleBlocks.splice(n,0,r._data),void i.render())}}}})}),ldc.app("prjForm");