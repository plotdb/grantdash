ldc.register("prjFormBlock",[],function(){var t,e,n,a,r,i;return t=function(t){var e,n,r,i,o,d,u;return e=t.node,n=t.data,r=t.viewMode,i=t.update,n,"form-checkpoint"===a.data.name&&r&&((n.value||(n.value={})).list?a.data.data=n.value.list:(n.value||(n.value={})).list=(o=a.data).data||(o.data=[]),ld$.find(e,".timeline-list",0).addEventListener("input",function(){return i(n)})),d=function(){var t,n;return t=ld$.find(e,"[ld=list-input]").map(function(t){return t.checked?t.getAttribute("data-name"):null}).filter(function(t){return t}),((n=a.data).value||(n.value={})).list=t,((n=a.data).value||(n.value={})).other=!!ld$.find(e,"[ld=list-other-option]",0).checked,i(a.data)},(e.view||(e.view={})).module=u=new ldView({root:e,action:{input:{"list-other":function(t){var e,n;return e=t.node,((n=a.data).value||(n.value={})).otherValue=e.value||"",i()}},click:{"list-add":function(){var t;return((t=a.data).data||(t.data=[])).push({title:"新項目",desc:"關於這個項目的描述 ... "}),i(),u.render()},"list-other-option":function(t){var e,n;return e=t.node,((n=a.data).value||(n.value={})).other=e.checked,i(),d()}}},handler:{"list-other":function(t){var e,n;return e=t.node,e.value=((n=a.data).value||(n.value={})).otherValue||""},"list-other-option":function(t){return t.node.setAttribute("name","radio-"+n.key)},list:{list:function(){var t;return(t=a.data).data||(t.data=[])},init:function(t){var e,n,o;return e=t.node,n=t.data,!(o=e.hasAttribute("data-user-editable"))&&r&&e.removeAttribute("draggable"),e.view=new ldView({root:e,action:{input:{"list-data":function(t){var e;return e=t.node,n[e.getAttribute("data-name")]=e.innerText,i()},"list-input":function(t){return t.node,d()}}},init:{"list-data":function(t){var e;if((e=t.node).setAttribute("data-name",e.getAttribute("editable")),!o&&r)return e.removeAttribute("editable")}},handler:{"list-input":function(t){var e;return(e=t.node).setAttribute("name","radio-"+a.data.key),e.setAttribute("data-name",n.title)},"list-data":function(t){var e;return e=t.node,e.innerText=n[e.getAttribute("data-name")]||""}}})},render:function(t){return t.node.render()}}}})},e=function(t){var e,n,a,r,i;return e=t.node,n=t.data,t.viewMode,a=t.update,r={},(e.view||(e.view={})).module=i=new ldView({root:e,action:{input:{"use-markdown":function(t){var e;return e=t.node,(n.value||(n.value={})).useMarkdown=e.checked,a(n),i.render()},"input-field":function(t){var e;return e=t.node,(n.value||(n.value={})).content=e.value,a(n)},"toggle-preview":function(t){var e;return e=t.node,r.preview=!!e.checked,i.render()}}},handler:{"input-field":function(t){var e;return e=t.node,e.value=(n.value||(n.value={})).content||""},"preview-panel":function(t){var e;if((e=t.node).classList.toggle("d-none",!r.preview),r.preview)return e.innerHTML=marked((n.value||(n.value={})).content||"")},"edit-panel":function(t){return t.node.classList.toggle("d-none",!!r.preview)},"if-markdown":function(t){return t.node.classList.toggle("d-none",!(n.value||(n.value={})).useMarkdown)}}})},n={"form-radio":t,"form-checkbox":t,"form-checkpoint":t,"form-long-answer":e,"form-short-answer":e},a={},r=function(t){var e,n,r;if(e=t.node,n=t.data,r=t.rootData,t.viewMode,t.update,a.data=n,a.rootData=r,e.view.block.render(),e.view.module)return e.view.module.render()},i=function(t){var e,r,i,o,d;if(e=t.node,r=t.data,i=t.rootData,o=t.viewMode,d=t.update,e.setAttribute("id","block-"+r.key),a.data=r,a.rootData=i,(e.view||(e.view={})).block=new ldView({root:e,action:{input:{title:function(t){var e;return e=t.node,t.evt,a.data.title=e.innerText,d()},desc:function(t){var e;return e=t.node,t.evt,a.data.desc=e.innerText,d()}},click:{switch:function(t){var e,n;return e=t.node,t.evt,e.classList.toggle("on"),((n=a.data).config||(n.config={}))[e.getAttribute("data-name")]=e.classList.contains("on"),d()},delete:function(t){return t.node,t.evt,a.rootData.splice(a.rootData.indexOf(r),1),d()},clone:function(t){var e;return t.node,t.evt,e=JSON.parse(JSON.stringify(a.data)),e.key=Math.random().toString(36).substring(2),a.rootData.splice(a.rootData.indexOf(a.data),0,e),d()}}},handler:{invalid:function(t){var e,n,r;return e=t.node,(n=!(null!=((r=a.data).valid||(r.valid={})).result)||a.data.valid.result)||(e.innerText=a.data.valid.criteria.invalid||"這個欄位格式不符"),e.classList.toggle("d-none",n)},block:function(t){var e,n,r;return e=t.node,n=!(null!=((r=a.data).valid||(r.valid={})).result)||a.data.valid.result,e.classList.toggle("invalid",!n)},title:function(t){var e;if((e=t.node).innerText!==a.data.title&&(e.innerText=a.data.title),o)return e.removeAttribute("editable")},desc:function(t){var e;if((e=t.node).innerText!==a.data.desc&&(e.innerText=a.data.desc),o)return e.removeAttribute("editable")},switch:function(t){var e,n;return(e=t.node).classList.toggle("on",!!((n=a.data).config||(n.config={}))[e.getAttribute("data-name")])},"edit-only":function(t){var e;if(e=t.node,o)return e.remove()},"list-input":function(t){return t.node.setAttribute("name","input-"+a.data.key)}}}),n[a.data.name])return n[a.data.name]({node:e,data:a.data,viewMode:o,update:d})},{init:i,render:r,module:n}});