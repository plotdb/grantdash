window.adminExtension={downloadProjects:function(n){var r,t,e,o,i,a=n.prjs,u=n.toc,c=n.grp,l=function(n){return(n.system||(n.system={})).idx?"111-"+(""+n.system.idx).padStart(3,"0"):n.key||"n/a"};if(console.log("here"),a[0]&&((n=(n=a[0]).detail||(n.detail={})).custom||(n.custom={})).open){for(e in r={},a.map(function(n){var t,e,o=[];for(t in e=(n=(n=n.detail||(n.detail={})).custom||(n.custom={})).open||(n.open={}))e[t],o.push(r[t]=1);return o}),t=[],r)t.push(e);return r=t,o=(r=["編號"].concat(r)).map(function(n){return""+(""+n).replace(/"/g,"'")}),i=a.map(function(e){return r.map(function(n){var t;return"編號"===n?{v:l(e)}:((t=(t=e.detail||(e.detail={})).custom||(t.custom={})).open||(t.open={}))[n]||""}).map(function(n){return"object"!=typeof n?n:n?null!=n.v?n.v:null!=n.list||null!=n.other&&null!=n.other.text?(n.list||[]).concat([n.other&&n.other.enabled&&n.other.text||""]).filter(function(n){return null!=n&&""!==n}):JSON.stringify(n):""}).map(function(n){return""+(""+n).replace(/"/g,"'")})}),{blob:o=csv4xls.toBlob([o].concat(i)),name:i=u.brd.name+"-"+c.info.name+".csv"}}return o=new Blob([JSON.stringify(a)],{type:"application/json"}),i="projects.json",res({blob:o,name:i})}};