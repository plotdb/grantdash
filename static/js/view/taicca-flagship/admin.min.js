function repeatString$(n,t){for(var o="";t>0;(t>>=1)&&(n+=n))1&t&&(o+=n);return o}window.adminExtension={downloadProjects:function(n){var t,o,e,r,a;return t=n.prjs,o=["編號","產業別","申請單位","計畫名稱","總經費","申請經費","申請經費佔比","107-109年文化部相關計畫補助情形","106-108年旗艦計畫補助情形","審查意見"],e=t.map(function(n){var t,o,e,r,a,s,u;return console.log(n),t=n.detail.custom.form,o=n.detail.custom.list,e=n.detail.custom.budget,r={"文化內容開發組":"01","內容產業領航行動組":"02"}[t.group],a=+(n.system||(n.system={})).idx,s=a?"109-"+r+"-"+(repeatString$("0",3-(a+"").length)+a):"-",u="文化內容開發組"===t.group?t["group1-category"]:t["group2-category"],[s,u.join("\n"),t.teamname,t.name,e.total||0,e.subsidy||0,Math.floor(1e4*e.percent.subsidy)/100+"%",o["past-sub"].map(function(n){return n.year+"年 / "+n.name+" / "+n.sponsor+" / "+n.amount}).join("\n")].map(function(n){return((n||"")+"").replace('"',"'")}).map(function(n){return'"'+n+'"'}).join(",")}),r=o.join(",")+"\n"+e.join("\n"),a=new Blob([r],{type:"text/csv"}),"projects.csv",{blob:a,name:"projects.csv"}}};