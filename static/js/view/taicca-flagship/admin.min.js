function repeatString$(t,n){for(var r="";n>0;(n>>=1)&&(t+=t))1&n&&(r+=t);return r}window.adminExtension={downloadProjects:function(t){var n,r,e,o,a,u,i,s;for(n=["編號","產業別","申請單位","計畫名稱","總經費","申請經費","申請經費佔比","107-109年文化部相關計畫補助情形","106-108年旗艦計畫補助情形","審查意見"],r=t.prjs.map(function(t){var n,r,e,o,a,u,i;return console.log(t),n=t.detail.custom.form,r=t.detail.custom.list,e=t.detail.custom.budget,o={"文化內容開發組":"01","內容產業領航行動組":"02"}[n.group],a=+(t.system||(t.system={})).idx,u=a?"109-"+o+"-"+(repeatString$("0",3-(a+"").length)+a):"-",i="文化內容開發組"===n.group?n["group1-category"]:n["group2-category"],[u,i.join("\r\n"),n.teamname,n.name,e.total||0,e.subsidy||0,Math.floor(1e4*e.percent.subsidy)/100+"%",r["past-sub"].filter(function(t){return t.value}).map(function(t){var n;return(n=t.value).year+"年 / "+n.name+" / "+n.sponsor+" / "+n.amount}).join("\r\n")].map(function(t){return((t||"")+"").replace('"',"'")}).map(function(t){return'"'+t+'"'}).join("\t")}),e=n.map(function(t){return'"'+t+'"'}).join("\t")+"\n"+r.join("\n"),o=new Uint8Array(2+2*e.length),a=0,u=e.length;a<u;++a)o[2*(i=a)+2]=e.charCodeAt(i),o[2*i+1+2]=e.charCodeAt(i)>>8;return o[0]=255,o[1]=254,s=new Blob([o],{type:"text/csv"}),"projects.csv",{blob:s,name:"projects.csv"}}};