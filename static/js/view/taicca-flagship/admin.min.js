function repeatString$(n,t){for(var e="";t>0;(t>>=1)&&(n+=n))1&t&&(e+=n);return e}window.adminExtension={downloadProjects:function(n){var t,e,o,r,a;return t=n.prjs,e=["編號","產業別","申請單位","計畫名稱","總經費","申請經費","申請經費佔比","107-109年文化部相關計畫補助情形","106-108年旗艦計畫補助情形","審查意見"],o=t.map(function(n){var t,e,o,r,a,u,i;return console.log(n),t=n.detail.custom.form,e=n.detail.custom.list,o=n.detail.custom.budget,r={"文化內容開發組":"01","內容產業領航行動組":"02"}[t.group],a=+(n.system||(n.system={})).idx,u=a?"109-"+r+"-"+(repeatString$("0",3-(a+"").length)+a):"-",i="文化內容開發組"===t.group?t["group1-category"]:t["group2-category"],[u,i.join("\n"),t.teamname,t.name,o.total||0,o.subsidy||0,Math.floor(1e4*o.percent.subsidy)/100+"%",e["past-sub"].filter(function(n){return n.value}).map(function(n){var t;return(t=n.value).year+"年 / "+t.name+" / "+t.sponsor+" / "+t.amount}).join("\n")].map(function(n){return((n||"")+"").replace('"',"'")}).map(function(n){return'"'+n+'"'}).join(",")}),r=e.join(",")+"\n"+o.join("\n"),a=new Blob([r],{type:"text/csv"}),"projects.csv",{blob:a,name:"projects.csv"}}};